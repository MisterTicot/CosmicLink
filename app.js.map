{"version":3,"sources":["webpack:///./src/app-widget.js","webpack:///./src/signing-ui.js","webpack:///./src/tamper.js","webpack:///./src/app.js","webpack:///./src/app-interface.js","webpack:///./src/helpers.js"],"names":["html","require","load","authenticators","the","parseQuery","query","params","substr","split","forEach","keyval","key","val","length","decodeURIComponent","async","referrer","document","join","hash","location","csp","grab","content","replace","handler","byId","authenticator","console","error","qrcode","qrCode","log","Object","keys","loading","css","push","Promise","all","then","show","body","main","exports","cosmicLib","CosmicLink","dom","env","QrCode","timeout","enableButton","disableButton","readWriteBox","readOnlyBox","disableBox","display","showIf","init","rewrite","cosmiclink_description","nodes","entry","append","value","name","redirect","redirectionCheckbox","checked","qrCodeUI","enable","localStorage","id","passphrase","resolve","networkPassphrase","config","setupNetwork","refresh","cosmicLink","tdesc","authenticatorUI","redirectionUI","transactionUI","needSource","accountId","needNetwork","customNetwork","horizon","network","source","saveTransaction","transaction","handle","status","getAccountId","accountMsgbox","accountUI","disable","networkUI","hide","accountDiv","undefined","accountIdBox","message","placeholder","networkDiv","customNetworkSetup","networkSelector","publicNetwork","scrollLeft","testNetwork","onscroll","customPassphrase","customHorizon","lock","disabled","selector","onchange","onExit","style","textOverflow","networkName","redirection","redirectionForm","textarea","textareaForm","qrForm","redirectionButton","xdrBox","loadingAnim","url","buttonText","href","click","contextIsWidget","onclick","clear","isEmbedded","target","open","window","parent","postMessage","redirectionMsgbox","sendTransaction","response","history","replaceState","textContent","send","back","type","create","canvas","title","scale","Math","max","floor","sqrt","toCanvas","margin","QR","qrButton","className","tamper","src","myHash","alphabet","i","charAt","random","signingUI","signingPage","Page","copyContent","add","sign","onSelect","pathname","search","origin","websiteUrl","header","about","sep7Utils","isWebHandlerSupported","registerSep7Handler","registerWebHandler","current","select","helpers","button","box","readOnly","cursor","element","classname","messageNode","flag","switchPage","from","to","activeElement","prevNode","destroy","copiedNode","parentNode","insertBefore","setTimeout","hidden"],"mappings":"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","file":"app.js","sourcesContent":["\"use strict\"\n/**\n * Widget interface initialization.\n */\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\nconst load = require(\"@cosmic-plus/domutils/es5/load\")\n\nconst authenticators = require(\"./authenticators\")\nconst the = require(\"./shared\")\n\n/* Functions */\n\nasync function initWidget () {\n  const referrer = document.referrer.split(\"/\", 3).join(\"/\")\n  const hash = location.hash\n  const params = parseQuery(hash)\n\n  // Strengthen Content-Security-Policy.\n  const csp = html.grab(\"meta[http-equiv='Content-Security-Policy']\")\n  csp.content = csp.content.replace(\n    \"style-src *  ;\",\n    `\n    style-src 'self'\n      'sha256-UpnKee22eAiBMULu1lvaV7de7xOzTjdN7K/WZDBil10='\n      ${referrer};\n  `\n  )\n\n  // Interface control.\n  if (params.handler) {\n    const handler = authenticators.byId[params.handler]\n    if (handler) {\n      the.authenticator = handler\n    } else {\n      console.error(`Unknown handler: ${params.handler}`)\n    }\n  }\n  if (params.qrcode) {\n    the.qrCode = params.qrcode !== \"false\"\n  }\n  // eslint-disable-next-line no-console\n  console.log(\"Valid handlers: \", Object.keys(authenticators.byId))\n\n  // Style control (asynchronous).\n  let loading = []\n  if (params.css) {\n    loading.push(load.css(`${referrer}/${params.css}`).catch(console.error))\n  } else {\n    loading.push(load.css(\"widget.css\").catch(console.error))\n    if (params[\"css+\"]) {\n      loading.push(\n        load.css(`${referrer}/${params[\"css+\"]}`).catch(console.error)\n      )\n    }\n  }\n  Promise.all(loading).then(() => html.show(document.body))\n\n  // Interface initialization.\n  require(\"./app-interface\")\n\n  // Consistent reload (app-interface mess with location.hash)\n  location.hash = hash\n}\n\n/* Helpers */\nfunction parseQuery (query) {\n  const params = {}\n\n  query\n    .substr(1)\n    .split(\"&\")\n    .forEach(keyval => {\n      const key = keyval.split(\"=\", 1)[0]\n      const val = keyval.substr(key.length + 1)\n      params[key] = decodeURIComponent(val)\n    })\n\n  return params\n}\n\n/* Initialization */\ninitWidget()\n","\"use strict\"\nconst main = exports\n\nconst cosmicLib = require(\"cosmic-lib\")\nconst CosmicLink = cosmicLib.CosmicLink\nconst dom = require(\"@cosmic-plus/domutils/es5/dom\")\nconst env = require(\"@cosmic-plus/jsutils/es5/env\")\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\nconst QrCode = require(\"qrcode\")\nconst { timeout } = require(\"@cosmic-plus/jsutils/es5/misc\")\n\nconst authenticators = require(\"./authenticators\")\nconst the = require(\"./shared\")\n\nconst {\n  enableButton,\n  disableButton,\n  readWriteBox,\n  readOnlyBox,\n  disableBox,\n  display,\n  showIf\n} = require(\"./helpers\")\n\n// Run once page is fully loaded\nmain.init = function () {\n  // Step 1: Transaction\n  if (!the.query) html.rewrite(dom.cosmiclink_description, \"No transaction\")\n\n  // Step 2: Authenticator\n  authenticators.nodes.forEach(entry => html.append(dom.authenticators, entry))\n  dom.authenticators.value = the.authenticator.name\n\n  // Step 3: Signing\n  if (the.redirect) dom.redirectionCheckbox.checked = true\n  if (the.qrCode) qrCodeUI.enable()\n\n  // CosmicLib network setup\n  for (let key in localStorage) {\n    if (key.substr(0, 8) === \"network:\") {\n      const id = key.substr(8)\n      const passphrase = cosmicLib.resolve.networkPassphrase(id)\n      cosmicLib.config.setupNetwork(id, localStorage[key], passphrase)\n    }\n  }\n}\n\nmain.refresh = async function () {\n  if (the.query) the.cosmicLink = new CosmicLink(the.query)\n  else the.cosmicLink = { tdesc: {} }\n  authenticatorUI.init()\n  redirectionUI.init()\n  if (the.cosmicLink.query) transactionUI.refresh()\n}\n\n/*******************************************************************************\n * Step 1: Transaction UI\n */\n\nconst transactionUI = {}\n\ntransactionUI.refresh = function () {\n  if (the.authenticator.needSource && !the.accountId) {\n    if (!the.authenticator.getAccountId) {\n      redirectionUI.error(\"Please set a source account\")\n    }\n    return\n  }\n  if (the.authenticator.needNetwork) {\n    if (dom.customNetwork.checked && (!the.horizon || !the.network)) {\n      redirectionUI.error(\"Please fill custom network fields\")\n      return\n    }\n  }\n\n  cosmicLib.config.source = the.accountId\n  cosmicLib.config.network = the.network\n\n  const saveTransaction = the.transaction = the.authenticator.handle(\n    the.cosmicLink\n  )\n\n  the.transaction\n    .then(function (value) {\n      if (the.transaction === saveTransaction) redirectionUI.refresh(value)\n    })\n    .catch(function () {\n      if (the.transaction === saveTransaction)\n        redirectionUI.error(the.cosmicLink.status)\n    })\n}\n\n/*******************************************************************************\n * Step 2: Authenticator UI\n */\n\nconst authenticatorUI = {}\n\nauthenticatorUI.init = function () {\n  display(dom.accountMsgbox, \"\")\n  the.authenticator = authenticators[dom.authenticators.value]\n  localStorage.authenticator = the.authenticator.name\n\n  if (the.authenticator.needSource) accountUI.init()\n  else accountUI.disable()\n  if (the.authenticator.needNetwork) networkUI.init()\n  else networkUI.disable()\n\n  if (the.authenticator.refresh) the.authenticator.refresh(main.refresh)\n}\n\n/**\n * AccountID box UI\n */\nconst accountUI = {}\n\naccountUI.disable = function () {\n  html.hide(dom.accountDiv)\n  the.accountId = undefined\n}\n\naccountUI.init = async function () {\n  html.show(dom.accountDiv)\n\n  if (!the.authenticator.getAccountId) {\n    if (the.cosmicLink.tdesc.source) {\n      if (the.cosmicLink.tdesc.source.error) {\n        disableBox(dom.accountIdBox, the.cosmicLink.tdesc.source.error.message)\n      } else {\n        the.accountId = true\n        readOnlyBox(dom.accountIdBox, the.cosmicLink.tdesc.source)\n      }\n    } else {\n      the.accountId = localStorage.accountId\n      readWriteBox(\n        dom.accountIdBox,\n        \"Your Account Address or ID\",\n        the.accountId\n      )\n    }\n  } else {\n    the.accountId = undefined\n    disableBox(dom.accountIdBox, \"Connecting...\")\n\n    const authenticator = the.authenticator\n    try {\n      const accountId = await the.authenticator.getAccountId()\n      if (the.authenticator !== authenticator) return\n      the.accountId = accountId\n      readOnlyBox(dom.accountIdBox, accountId)\n      transactionUI.refresh()\n    } catch (error) {\n      if (the.authenticator !== authenticator) return\n      dom.accountIdBox.placeholder = \"Error\"\n      display(dom.accountMsgbox, \"error\", error.message + \".\")\n      console.error(error)\n    }\n  }\n}\n\n/**\n * Network selection UI\n */\nconst networkUI = {}\n\nnetworkUI.disable = function () {\n  html.hide(dom.networkDiv)\n  the.network = \"public\"\n  the.horizon = undefined\n}\n\nnetworkUI.init = function () {\n  html.show(dom.networkDiv)\n  html.hide(dom.customNetworkSetup)\n  the.network = the.cosmicLink.tdesc.network || localStorage.networkSelector\n  the.horizon = undefined\n\n  switch (the.network) {\n  case undefined:\n  case \"public\":\n    dom.publicNetwork.checked = true\n    dom.networkSelector.scrollLeft = 0\n    break\n  case \"test\":\n    dom.testNetwork.checked = true\n    break\n  default:\n    if (dom.networkSelector.onscroll) dom.networkSelector.onscroll()\n    // Doesn't works when called synchronously.\n    timeout(1).then(() => dom.networkSelector.scrollLeft = 999)\n    dom.customNetwork.checked = true\n\n    html.show(dom.customNetworkSetup)\n    if (!the.network) the.network = localStorage.customPassphrase\n    the.horizon =\n        cosmicLib.resolve.horizon(the.network || \"\")\n        || the.cosmicLink.tdesc.horizon\n    dom.customPassphrase.value = the.network || \"\"\n    dom.customHorizon.value = the.horizon || \"\"\n  }\n\n  if (the.cosmicLink.tdesc.network) networkUI.lock()\n}\n\nnetworkUI.lock = function () {\n  readOnlyBox(dom.customPassphrase)\n  dom.publicNetwork.disabled = true\n  dom.testNetwork.disabled = true\n  dom.customNetwork.disabled = true\n}\n\nnetworkUI.switch = function (selector) {\n  localStorage.networkSelector = selector\n  main.refresh()\n}\n\n/**\n * HTML Elements Events\n */\n\ndom.authenticators.onchange = function () {\n  if (the.authenticator && the.authenticator.onExit) the.authenticator.onExit()\n  the.redirect = localStorage.redirect = false\n  dom.redirectionCheckbox.checked = false\n  main.refresh()\n}\n\ndom.accountIdBox.onchange = function () {\n  the.accountId = localStorage.accountId = dom.accountIdBox.value\n  main.refresh()\n}\n\ndom.networkSelector.onscroll = function () {\n  dom.networkSelector.style.textOverflow = \"initial\"\n  dom.networkSelector.onscroll = undefined\n}\n\ndom.publicNetwork.onchange = () => networkUI.switch(\"public\")\ndom.testNetwork.onchange = () => networkUI.switch(\"test\")\ndom.customNetwork.onchange = () => networkUI.switch(\"\")\n\ndom.customPassphrase.onchange = function () {\n  const networkName = cosmicLib.resolve.networkName(dom.customPassphrase.value)\n  localStorage.customPassphrase = networkName\n  networkUI.switch(\"\")\n}\n\ndom.customHorizon.onchange = function () {\n  the.horizon = dom.customHorizon.value\n  if (the.horizon && the.horizon.substr(0, 4) !== \"http\") {\n    the.horizon = \"https://\" + the.horizon\n  }\n  if (the.network && the.horizon) {\n    const passphrase = cosmicLib.resolve.networkPassphrase(the.network)\n    cosmicLib.config.setupNetwork(the.network, the.horizon, passphrase)\n    localStorage[\"network:\" + passphrase] = the.horizon\n  }\n  if (the.network) main.refresh()\n}\n\n/*******************************************************************************\n * Step 3: Signing/Redirection UI\n */\n\nconst redirectionUI = {}\n\nredirectionUI.init = function () {\n  redirectionUI.display(\"\")\n  showIf(the.authenticator.redirection, dom.redirectionForm)\n  showIf(the.authenticator.textarea, dom.textareaForm)\n  showIf(the.query && the.authenticator.qrCode, dom.qrForm)\n\n  if (!the.query) {\n    if (the.authenticator.url) {\n      const onclick = () => location.href = the.authenticator.url\n      enableButton(dom.redirectionButton, the.authenticator.buttonText, onclick)\n    } else {\n      redirectionUI.error(\"No transaction\")\n    }\n  } else {\n    if (the.authenticator.redirection) disableButton(dom.redirectionButton, \"…\")\n    if (the.authenticator.textarea) disableBox(dom.xdrBox, \"Computing...\")\n    if (the.authenticator.qrCode) qrCodeUI.loadingAnim()\n  }\n}\n\nredirectionUI.refresh = function (value) {\n  if (the.authenticator.redirection) {\n    const onclick = () => redirectionUI.click(value)\n    enableButton(dom.redirectionButton, the.authenticator.buttonText, onclick)\n  }\n\n  if (the.redirect && !the.contextIsWidget) {\n    dom.redirectionButton.onclick()\n  }\n\n  if (the.authenticator.textarea) readOnlyBox(dom.xdrBox, value)\n  if (the.authenticator.qrCode) qrCodeUI.refresh(value)\n}\n\nredirectionUI.error = function (error) {\n  disableButton(dom.redirectionButton, error)\n  disableBox(dom.xdrBox, error)\n  html.clear(dom.qrCode)\n}\n\nredirectionUI.click = async function (value) {\n  if (typeof value === \"string\") {\n    if (\n      the.contextIsWidget\n      || env.isEmbedded && the.authenticator.target === \"new\"\n    ) {\n      open(value, \"_blank\")\n      window.parent.postMessage(\"close\", \"*\")\n    } else if (env.isEmbedded && the.authenticator.target === \"external\") {\n      open(value)\n      window.parent.postMessage(\"close\", \"*\")\n    } else {\n      location.replace(value)\n    }\n  } else if (typeof value === \"function\") {\n    display(dom.redirectionMsgbox, \"info\", \"Waiting for confirmation...\")\n    dom.redirectionButton.disabled = true\n\n    try {\n      const transaction = await value()\n      await redirectionUI.sendTransaction(transaction)\n    } catch (error) {\n      console.error(error.response || error)\n      redirectionUI.display(\"error\", error.message.replace(/\\.$/, \"\"))\n      dom.redirectionButton.disabled = false\n    }\n  }\n}\n\nredirectionUI.sendTransaction = async function () {\n  redirectionUI.display(\"info\", \"Sending to the network...\")\n  history.replaceState({}, \"\", the.cosmicLink.query)\n  dom.query.textContent = the.cosmicLink.query\n  networkUI.lock()\n\n  await the.cosmicLink.send()\n  redirectionUI.display(\"info\", \"Transaction validated\")\n  if (env.isEmbedded) parent.postMessage(\"close\", \"*\")\n  if (document.referrer) {\n    enableButton(dom.redirectionButton, \"Close\", () => history.back())\n  } else {\n    dom.redirectionButton.value = \"Done\"\n  }\n}\n\nredirectionUI.display = function (type, message) {\n  display(dom.redirectionMsgbox, type, message)\n}\n\nconst qrCodeUI = {}\n\nqrCodeUI.loadingAnim = function () {\n  html.rewrite(dom.qrCode, html.create(\"span\", \".cosmiclib_loadingAnim\"))\n}\n\nqrCodeUI.refresh = async function (value) {\n  // Makes that fuction non-blocking.\n  await timeout(0)\n\n  if (!the.authenticator.qrCode || !value) return\n\n  const canvas = html.create(\"canvas\", { title: value })\n  const scale = Math.max(3, 6 - Math.floor(Math.sqrt(value) / 10))\n  QrCode.toCanvas(canvas, value, { margin: 0, scale })\n\n  html.rewrite(dom.qrCode, canvas)\n}\n\nqrCodeUI.switch = function () {\n  the.qrCode = localStorage.QR = !the.qrCode\n  if (the.qrCode) qrCodeUI.enable()\n  else qrCodeUI.disable()\n}\n\nqrCodeUI.enable = function () {\n  dom.qrButton.className = \"enabled\"\n  html.show(dom.qrCode)\n}\n\nqrCodeUI.disable = function () {\n  dom.qrButton.className = undefined\n  html.hide(dom.qrCode)\n}\n\n/**\n * HTML Elements Events\n */\n\ndom.redirectionButton.onclick = redirectionUI.click\ndom.qrButton.onclick = qrCodeUI.switch\n\ndom.redirectionCheckbox.onchange = function () {\n  the.redirect = localStorage.redirect = !the.redirect\n}\n","\"use strict\"\n/**\n * Robot tamper.\n */\nconst dom = require(\"@cosmic-plus/domutils/es5/dom\")\n\nfunction myHash () {\n  if (localStorage.myHash) return localStorage.myHash\n\n  var alphabet =\n    \"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\"\n  var size = 32\n\n  var hash = \"\"\n  for (var i = 0; i < size; i++) {\n    hash += alphabet.charAt(Math.floor(Math.random() * alphabet.length))\n  }\n\n  localStorage.myHash = hash\n  return hash\n}\n\ndom.tamper.src = \"https://robohash.org/\" + myHash()\n","\"use strict\"\n/**\n * Cosmic.Link Graphical User Interface\n */\nconst the = require(\"./shared\")\n\nif (the.contextIsWidget) {\n  require(\"./app-widget\")\n} else {\n  require(\"./app-interface\")\n}\n","\"use strict\"\n/**\n * App interface initialization.\n */\nconst cosmicLib = require(\"cosmic-lib\")\nconst dom = require(\"@cosmic-plus/domutils/es5/dom\")\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\nconst Page = require(\"@cosmic-plus/domutils/es5/page\")\n\nconst the = require(\"./shared\")\nconst { copyContent } = require(\"./helpers\")\n\n/* Functions */\n\nfunction initInterface () {\n  // Signing interface\n  const signingUI = require(\"./signing-ui\")\n  const signingPage = Page.add(\"Sign\", dom.sign)\n  signingPage.onSelect = function () {\n    history.replaceState(\"\", null, location.pathname + location.search)\n    signingUI.refresh()\n  }\n  signingUI.init()\n\n  // Non-widget components\n  if (!the.contextIsWidget) {\n    initNonWidgetInterface()\n  }\n\n  // Default page\n  if (Page.current === signingPage) signingPage.onSelect()\n  else if (!Page.current) Page.select(\"#sign\")\n}\n\nfunction initNonWidgetInterface () {\n  // Header\n  if (location.origin === \"null\") {\n    dom.websiteUrl.textContent = location.pathname\n  } else {\n    dom.websiteUrl.textContent = location.origin + location.pathname\n  }\n  dom.query.textContent = location.search\n  dom.header.onclick = () => copyContent(dom.header)\n\n  // About page\n  Page.add(\"About\", dom.about)\n\n  // SEP-0007\n  if (cosmicLib.sep7Utils.isWebHandlerSupported()) {\n    dom.registerSep7Handler.onclick = () => {\n      cosmicLib.sep7Utils.registerWebHandler(\n        location.href.split(/[?#]/, 1)[0],\n        \"Cosmic.link\"\n      )\n    }\n  } else {\n    // (hack) Keep the collapsed bottom margin.\n    dom.registerSep7Handler.textContent = \"\"\n  }\n  html.show(dom.registerSep7Handler)\n\n  // Robot tamper\n  require(\"./tamper\")\n}\n\n/* Init */\ninitInterface()\n","\"use strict\"\n/**\n * Generic helpers\n */\nconst helpers = exports\n\nconst dom = require(\"@cosmic-plus/domutils/es5/dom\")\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\n\n/*******************************************************************************\n * Form Elements Helpers\n */\n\nhelpers.enableButton = function (button, value, onclick) {\n  if (typeof value === \"string\") button.value = value\n  button.onclick = onclick\n  button.disabled = false\n}\n\nhelpers.disableButton = function (button, value) {\n  if (typeof value === \"string\") button.value = value\n  button.disabled = true\n}\n\nhelpers.readWriteBox = function (box, placeholder, value) {\n  if (typeof value === \"string\") box.value = value\n  if (typeof placeholder === \"string\") box.placeholder = placeholder\n  box.disabled = false\n  box.readOnly = false\n  box.onclick = undefined\n  box.style.cursor = \"initial\"\n}\n\nhelpers.readOnlyBox = function (box, value) {\n  if (typeof value === \"string\") box.value = value\n  box.disabled = false\n  box.readOnly = true\n  box.onclick = () => helpers.copyContent(box)\n  box.style.cursor = \"pointer\"\n}\n\nhelpers.disableBox = function (box, placeholder) {\n  helpers.readWriteBox(box, placeholder, \"\")\n  box.disabled = true\n}\n\n/*******************************************************************************\n * Other Helpers\n */\n\nhelpers.display = function (element, type = \"\", message = \"\") {\n  const classname = type ? \".\" + type : null\n  const messageNode = classname\n    ? html.create(\"span\", classname, message)\n    : message\n  html.rewrite(element, html.create(\"span\", classname, messageNode))\n}\n\nhelpers.showIf = function (flag, element) {\n  flag ? html.show(element) : html.hide(element)\n}\n\nhelpers.switchPage = function (from, to) {\n  html.append(dom.body, from)\n  html.append(dom.main, to)\n}\n\nhelpers.copyContent = function (element) {\n  if (html.copyContent(element) && document.activeElement.value) {\n    const prevNode = html.grab(\"#copied\")\n    if (prevNode) html.destroy(prevNode)\n    const copiedNode = html.create(\"span\", \"#copied\", \"Copied\")\n    element.parentNode.insertBefore(copiedNode, element)\n    setTimeout(() => {\n      copiedNode.hidden = true\n    }, 3000)\n  }\n}\n"],"sourceRoot":""}