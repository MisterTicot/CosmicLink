(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{101:function(e,t,n){"use strict";var r=n(0),o=n(1),c=n(6),i=n(60),a=n(10),s=n(9);function u(){return(u=o(r.mark((function e(){var t,o,u,d,h,f;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=document.referrer.split("/",3).join("/"),o=location.hash,u=l(o),(d=c.grab("meta[http-equiv='Content-Security-Policy']")).content=d.content.replace("style-src *  ;","\n    style-src 'self'\n      'sha256-UpnKee22eAiBMULu1lvaV7de7xOzTjdN7K/WZDBil10='\n      ".concat(t,";\n  ")),u.handler&&((h=a.byId[u.handler])?s.authenticator=h:console.error("Unknown handler: ".concat(u.handler))),u.qrcode&&(s.qrCode="false"!==u.qrcode),console.log("Valid handlers: ",Object.keys(a.byId)),f=[],u.css?f.push(i.css("".concat(t,"/").concat(u.css)).catch(console.error)):(f.push(i.css("widget.css").catch(console.error)),u["css+"]&&f.push(i.css("".concat(t,"/").concat(u["css+"])).catch(console.error))),Promise.all(f).then((function(){return c.show(document.body)})),n(61),location.hash=o;case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(e){var t={};return e.substr(1).split("&").forEach((function(e){var n=e.split("=",1)[0],r=e.substr(n.length+1);t[n]=decodeURIComponent(r)})),t}!function(){u.apply(this,arguments)}()},112:function(e,t,n){"use strict";var r=n(0),o=n(1),c=t,i=n(50),a=i.CosmicLink,s=n(43),u=n(7),l=n(6),d=n(113),h=n(5).timeout,f=n(137),p=n(10),k=n(9),w=n(68),v=w.enableButton,m=w.disableButton,b=w.readWriteBox,g=w.readOnlyBox,x=w.disableBox,y=w.display,S=w.showIf;c.init=function(){for(var e in k.query||l.rewrite(s.cosmiclink_description,"No transaction"),p.nodes.forEach((function(e){return l.append(s.authenticators,e)})),s.authenticators.value=k.authenticator.name,k.redirect&&(s.redirectionCheckbox.checked=!0),k.qrCode&&N.enable(),localStorage)if("network:"===e.substr(0,8)){var t=e.substr(8),n=i.resolve.networkPassphrase(t);i.config.setupNetwork(t,localStorage[e],n)}},c.refresh=o(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k.query?k.cosmicLink=new a(k.query):k.cosmicLink={tdesc:{}},C.init(),L.init(),k.cosmicLink.query&&B.refresh();case 4:case"end":return e.stop()}}),e)})));var B={refresh:function(){if(!k.authenticator.needSource||k.accountId)if(!k.authenticator.needNetwork||!s.customNetwork.checked||k.horizon&&k.network){i.config.source=k.accountId,i.config.network=k.network;var e=k.transaction=k.authenticator.handle(k.cosmicLink);k.transaction.then((function(t){k.transaction===e&&L.refresh(t)})).catch((function(){k.transaction===e&&L.error(k.cosmicLink.status)}))}else L.error("Please fill custom network fields");else k.authenticator.getAccountId||L.error("Please set a source account")}},C={init:function(){y(s.accountMsgbox,""),k.authenticator=p[s.authenticators.value],localStorage.authenticator=k.authenticator.name,k.authenticator.needSource?q.init():q.disable(),k.authenticator.needNetwork?I.init():I.disable(),k.authenticator.refresh&&k.authenticator.refresh(c.refresh)}},q={disable:function(){l.hide(s.accountDiv),k.accountId=void 0}};q.init=o(r.mark((function e(){var t,n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l.show(s.accountDiv),k.authenticator.getAccountId){e.next=5;break}k.cosmicLink.tdesc.source?k.cosmicLink.tdesc.source.error?x(s.accountIdBox,k.cosmicLink.tdesc.source.error.message):(k.accountId=!0,g(s.accountIdBox,k.cosmicLink.tdesc.source)):(k.accountId=localStorage.accountId,b(s.accountIdBox,"Federated Address or Public Key",k.accountId)),e.next=26;break;case 5:return k.accountId=void 0,x(s.accountIdBox,"Connecting..."),t=k.authenticator,e.prev=8,e.next=11,k.authenticator.getAccountId();case 11:if(n=e.sent,k.authenticator===t){e.next=14;break}return e.abrupt("return");case 14:k.accountId=n,g(s.accountIdBox,n),B.refresh(),e.next=26;break;case 19:if(e.prev=19,e.t0=e.catch(8),k.authenticator===t){e.next=23;break}return e.abrupt("return");case 23:s.accountIdBox.placeholder="Error",y(s.accountMsgbox,"error",e.t0.message+"."),console.error(e.t0);case 26:case"end":return e.stop()}}),e,null,[[8,19]])})));var I={disable:function(){l.hide(s.networkDiv),k.network="public",k.horizon=void 0},init:function(){switch(l.show(s.networkDiv),l.hide(s.customNetworkSetup),k.network=k.cosmicLink.tdesc.network||localStorage.networkSelector||"public",k.horizon=void 0,k.network){case void 0:case"public":s.publicNetwork.checked=!0,s.networkSelector.scrollLeft=0;break;case"test":s.testNetwork.checked=!0;break;default:s.networkSelector.onscroll&&s.networkSelector.onscroll(),h(1).then((function(){return s.networkSelector.scrollLeft=999})),s.customNetwork.checked=!0,l.show(s.customNetworkSetup),k.network||(k.network=localStorage.customPassphrase),k.horizon=i.resolve.horizon(k.network||"")||k.cosmicLink.tdesc.horizon,s.customPassphrase.value=k.network||"",s.customHorizon.value=k.horizon||""}k.cosmicLink.tdesc.network&&I.lock()},lock:function(){g(s.customPassphrase),s.publicNetwork.disabled=!0,s.testNetwork.disabled=!0,s.customNetwork.disabled=!0},switch:function(e){localStorage.networkSelector=e,c.refresh()}};s.authenticators.onchange=function(){k.authenticator&&k.authenticator.onExit&&k.authenticator.onExit(),k.redirect=localStorage.redirect=!1,s.redirectionCheckbox.checked=!1,c.refresh()},s.accountIdBox.onchange=function(){k.accountId=localStorage.accountId=s.accountIdBox.value,c.refresh()},s.networkSelector.onscroll=function(){s.networkSelector.style.textOverflow="initial",s.networkSelector.onscroll=void 0},s.publicNetwork.onchange=function(){return I.switch("public")},s.testNetwork.onchange=function(){return I.switch("test")},s.customNetwork.onchange=function(){return I.switch("")},s.customPassphrase.onchange=function(){var e=i.resolve.networkName(s.customPassphrase.value);localStorage.customPassphrase=e,I.switch("")},s.customHorizon.onchange=function(){if(k.horizon=s.customHorizon.value,k.horizon&&"http"!==k.horizon.substr(0,4)&&(k.horizon="https://"+k.horizon),k.network&&k.horizon){var e=i.resolve.networkPassphrase(k.network);i.config.setupNetwork(k.network,k.horizon,e),localStorage["network:"+e]=k.horizon}k.network&&c.refresh()};var L={init:function(){if(L.display(""),S(k.authenticator.redirection,s.redirectionForm),S(k.authenticator.textarea,s.textareaForm),S(k.query&&k.authenticator.qrCode,s.qrForm),k.query)k.authenticator.redirection&&m(s.redirectionButton,"â€¦"),k.authenticator.textarea&&x(s.xdrBox,"Computing..."),k.authenticator.qrCode&&N.loadingAnim();else if(k.authenticator.url){v(s.redirectionButton,k.authenticator.buttonText,(function(){return location.href=k.authenticator.url}))}else L.error("No transaction")},refresh:function(e){if(k.authenticator.redirection){v(s.redirectionButton,k.authenticator.buttonText,(function(){return L.click(e)}))}k.redirect&&!k.contextIsWidget&&s.redirectionButton.onclick(),k.authenticator.textarea&&g(s.xdrBox,e),k.authenticator.qrCode&&N.refresh(e)},error:function(e){m(s.redirectionButton,e),x(s.xdrBox,e),l.clear(s.qrCode)}};L.click=function(){var e=o(r.mark((function e(t){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t){e.next=4;break}k.contextIsWidget||u.isEmbedded&&"new"===k.authenticator.target?(open(t,"_blank"),window.parent.postMessage("close","*")):u.isEmbedded&&"external"===k.authenticator.target?(open(t),window.parent.postMessage("close","*")):location.replace(t),e.next=20;break;case 4:if("function"!=typeof t){e.next=20;break}return y(s.redirectionMsgbox,"info","Waiting for confirmation..."),s.redirectionButton.disabled=!0,e.prev=7,e.next=10,t();case 10:return n=e.sent,e.next=13,L.sendTransaction(n);case 13:e.next=20;break;case 15:e.prev=15,e.t0=e.catch(7),console.error(e.t0.response||e.t0),L.display("error",e.t0.message.replace(/\.$/,"")),s.redirectionButton.disabled=!1;case 20:case"end":return e.stop()}}),e,null,[[7,15]])})));return function(t){return e.apply(this,arguments)}}(),L.sendTransaction=o(r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return L.display("info","Sending to the network..."),delete k.cosmicLink._query,delete k.cosmicLink._xdr,k.query=k.cosmicLink.query,history.replaceState({},"",k.query),I.lock(),s.query&&(s.query.textContent=k.query),window.scrollTo(0,document.body.scrollHeight),e.next=10,f.forCosmicLink(k.cosmicLink);case 10:t=e.sent,L.display("",t),t.validated&&u.isEmbedded&&parent.postMessage("close","*"),document.referrer?v(s.redirectionButton,"Close",(function(){return history.back()})):s.redirectionButton.value="Done";case 14:case"end":return e.stop()}}),e)}))),L.display=function(e,t){y(s.redirectionMsgbox,e,t)};var N={loadingAnim:function(){l.rewrite(s.qrCode,l.create("span",".cosmiclib_loadingAnim"))}};N.refresh=function(){var e=o(r.mark((function e(t){var n,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(0);case 2:if(k.authenticator.qrCode&&t){e.next=4;break}return e.abrupt("return");case 4:n=l.create("canvas",{title:t}),o=Math.max(3,6-Math.floor(Math.sqrt(t)/10)),d.toCanvas(n,t,{margin:0,scale:o}),l.rewrite(s.qrCode,n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N.switch=function(){k.qrCode=localStorage.QR=!k.qrCode,k.qrCode?N.enable():N.disable()},N.enable=function(){s.qrButton.className="enabled",l.show(s.qrCode)},N.disable=function(){s.qrButton.className=void 0,l.hide(s.qrCode)},s.redirectionButton.onclick=L.click,s.qrButton.onclick=N.switch,s.redirectionCheckbox.onchange=function(){k.redirect=localStorage.redirect=!k.redirect}},137:function(e,t,n){"use strict";var r=n(0),o=n(1),c=n(2),i=n(33),a=n(3),s=n(31),u=n(32),l=n(26);function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var o=l(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return u(this,n)}}var h=n(138),f=n(6),p=n(148),k=function(e){s(u,e);var t,n=d(u);function u(e){var t;return c(this,u),t=n.call(this,'\n<div class="cosmiclink_description">\n\n  <span class=%state>%title</span>\n\n  <ul class="error" hidden=%validated>\n    %{toLi:errors...}\n  </ul>\n\n</div>\n    '),Object.assign(i(t),e),t.state=t.validated?"info":"error",t}return a(u,null,[{key:"forCosmicLink",value:(t=o(r.mark((function e(t){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.forCosmicLink(t);case 2:return n=e.sent,e.abrupt("return",new u(n));case 4:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"fromResponse",value:function(e){return new u(new p(e))}}]),a(u,[{key:"has",value:function(e){return!!e}},{key:"toLi",value:function(e){return f.create("li",null,e)}}]),u}(h);e.exports=k},150:function(e,t,n){"use strict";n(43).tamper.src="https://robohash.org/"+function(){if(localStorage.myHash)return localStorage.myHash;for(var e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",t="",n=0;n<32;n++)t+=e.charAt(Math.floor(Math.random()*e.length));return localStorage.myHash=t,t}()},19:function(e,t,n){"use strict";n(9).contextIsWidget?n(101):n(61)},61:function(e,t,n){"use strict";var r,o,c=n(50),i=n(43),a=n(6),s=n(111),u=n(9),l=n(68).copyContent;r=n(112),(o=s.add("Sign",i.sign)).onSelect=function(){history.replaceState("",null,location.pathname+location.search),r.refresh()},r.init(),u.contextIsWidget||("null"===location.origin?i.websiteUrl.textContent=location.pathname:i.websiteUrl.textContent=location.origin+location.pathname,i.query.textContent=location.search,i.header.onclick=function(){return l(i.header)},s.add("About",i.about),c.sep7Utils.isWebHandlerSupported()?i.registerSep7Handler.onclick=function(){c.sep7Utils.registerWebHandler(location.href.split(/[?#]/,1)[0],"Cosmic.link")}:i.registerSep7Handler.textContent="",a.show(i.registerSep7Handler),n(150)),s.current===o?o.onSelect():s.current||s.select("#sign")},68:function(e,t,n){"use strict";var r=t,o=n(43),c=n(6);r.enableButton=function(e,t,n){"string"==typeof t&&(e.value=t),e.onclick=n,e.disabled=!1},r.disableButton=function(e,t){"string"==typeof t&&(e.value=t),e.disabled=!0},r.readWriteBox=function(e,t,n){"string"==typeof n&&(e.value=n),"string"==typeof t&&(e.placeholder=t),e.disabled=!1,e.readOnly=!1,e.onclick=void 0,e.style.cursor="initial"},r.readOnlyBox=function(e,t){"string"==typeof t&&(e.value=t),e.disabled=!1,e.readOnly=!0,e.onclick=function(){return r.copyContent(e)},e.style.cursor="pointer"},r.disableBox=function(e,t){r.readWriteBox(e,t,""),e.disabled=!0},r.display=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=t?"."+t:null,o=r?c.create("span",r,n):n;c.rewrite(e,c.create("span",r,o))},r.showIf=function(e,t){e?c.show(t):c.hide(t)},r.switchPage=function(e,t){c.append(o.body,e),c.append(o.main,t)},r.copyContent=function(e){if(c.copyContent(e)&&document.activeElement.value){var t=c.grab("#copied");t&&c.destroy(t);var n=c.create("span","#copied","Copied");e.parentNode.insertBefore(n,e),setTimeout((function(){n.hidden=!0}),3e3)}}}}]);
//# sourceMappingURL=app.js.map