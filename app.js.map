{"version":3,"sources":["webpack:///./src/app.js","webpack:///./src/helpers.js","webpack:///./src/tamper.js","webpack:///./src/signing-ui.js"],"names":["cosmicLib","require","dom","html","Page","copyContent","location","origin","websiteUrl","textContent","pathname","query","search","header","onclick","sep7Utils","isWebHandlerSupported","show","registerSep7Handler","registerWebHandler","href","split","signingUI","signingPage","add","sign","onSelect","history","replaceState","refresh","init","help","current","select","helpers","exports","enableButton","button","value","disabled","disableButton","readWriteBox","box","placeholder","readOnly","undefined","style","cursor","readOnlyBox","disableBox","display","element","type","message","classname","messageNode","create","rewrite","showIf","flag","hide","switchPage","from","to","append","body","main","document","activeElement","prevNode","grab","destroy","copiedNode","parentNode","insertBefore","setTimeout","hidden","tamper","src","localStorage","myHash","alphabet","hash","i","charAt","Math","floor","random","length","CosmicLink","env","QrCode","timeout","authenticators","the","key","cosmiclink_description","nodes","forEach","entry","authenticator","name","redirect","redirectionCheckbox","checked","qrCode","qrCodeUI","enable","substr","id","passphrase","resolve","networkPassphrase","config","setupNetwork","cosmicLink","tdesc","authenticatorUI","redirectionUI","transactionUI","needSource","accountId","needNetwork","customNetwork","horizon","network","source","saveTransaction","transaction","handle","then","error","status","getAccountId","accountMsgbox","accountUI","disable","networkUI","accountDiv","accountIdBox","console","networkDiv","customNetworkSetup","networkSelector","publicNetwork","scrollLeft","testNetwork","onscroll","customPassphrase","customHorizon","lock","selector","onchange","onExit","textOverflow","networkName","redirection","redirectionForm","textarea","textareaForm","qrForm","redirectionButton","xdrBox","loadingAnim","url","buttonText","click","clear","isEmbedded","target","open","window","parent","postMessage","replace","redirectionMsgbox","sendTransaction","response","send","referrer","back","canvas","toCanvas","margin","scale","title","QR","qrButton","className"],"mappings":"4EAIA,IAAMA,EAAYC,EAAQ,IACpBC,EAAMD,EAAQ,IACdE,EAAOF,EAAQ,GACfG,EAAOH,EAAQ,IAEbI,EAAgBJ,EAAQ,IAAxBI,YAGgB,SAApBC,SAASC,OAAmBL,EAAIM,WAAWC,YAAcH,SAASI,SACjER,EAAIM,WAAWC,YAAcH,SAASC,OAASD,SAASI,SAC7DR,EAAIS,MAAMF,YAAcH,SAASM,OACjCV,EAAIW,OAAOC,QAAU,kBAAMT,EAAYH,EAAIW,SAG3CZ,EAAQ,IAGJD,EAAUe,UAAUC,0BACtBb,EAAKc,KAAKf,EAAIgB,qBACdhB,EAAIgB,oBAAoBJ,QAAU,WAChCd,EAAUe,UAAUI,mBAClBb,SAASc,KAAKC,MAAM,OAAQ,GAAG,GAC/B,iBAMN,IAAMC,EAAYrB,EAAQ,IACpBsB,EAAcnB,EAAKoB,IAAI,OAAQtB,EAAIuB,MACzCF,EAAYG,SAAW,WACrBC,QAAQC,aAAa,GAAI,KAAMtB,SAASI,SAAWJ,SAASM,QAC5DU,EAAUO,WAGZP,EAAUQ,OAGV1B,EAAKoB,IAAI,OAAQtB,EAAI6B,MAGjB3B,EAAK4B,UAAYT,EAAaA,EAAYG,WACpCtB,EAAK4B,SAAS5B,EAAK6B,OAAO,U,mBC1CpC,IAAMC,EAAUC,EAEVjC,EAAMD,EAAQ,IACdE,EAAOF,EAAQ,GAMrBiC,EAAQE,aAAe,SAAUC,EAAQC,EAAOxB,GACzB,iBAAVwB,IAAoBD,EAAOC,MAAQA,GAC9CD,EAAOvB,QAAUA,EACjBuB,EAAOE,UAAW,GAGpBL,EAAQM,cAAgB,SAAUH,EAAQC,GACnB,iBAAVA,IAAoBD,EAAOC,MAAQA,GAC9CD,EAAOE,UAAW,GAGpBL,EAAQO,aAAe,SAAUC,EAAKC,EAAaL,GAC5B,iBAAVA,IAAoBI,EAAIJ,MAAQA,GAChB,iBAAhBK,IAA0BD,EAAIC,YAAcA,GACvDD,EAAIH,UAAW,EACfG,EAAIE,UAAW,EACfF,EAAI5B,aAAU+B,EACdH,EAAII,MAAMC,OAAS,WAGrBb,EAAQc,YAAc,SAAUN,EAAKJ,GACd,iBAAVA,IAAoBI,EAAIJ,MAAQA,GAC3CI,EAAIH,UAAW,EACfG,EAAIE,UAAW,EACfF,EAAI5B,QAAU,kBAAMoB,EAAQ7B,YAAYqC,IACxCA,EAAII,MAAMC,OAAS,WAGrBb,EAAQe,WAAa,SAAUP,EAAKC,GAClCT,EAAQO,aAAaC,EAAKC,EAAa,IACvCD,EAAIH,UAAW,GAOjBL,EAAQgB,QAAU,SAAUC,GAAkC,IAAzBC,EAAyB,uDAAlB,GAAIC,EAAc,uDAAJ,GAClDC,EAAYF,EAAO,IAAMA,EAAO,KAChCG,EAAcD,EAChBnD,EAAKqD,OAAO,OAAQF,EAAWD,GAC/BA,EACJlD,EAAKsD,QAAQN,EAAShD,EAAKqD,OAAO,OAAQF,EAAWC,KAGvDrB,EAAQwB,OAAS,SAAUC,EAAMR,GAC/BQ,EAAOxD,EAAKc,KAAKkC,GAAWhD,EAAKyD,KAAKT,IAGxCjB,EAAQ2B,WAAa,SAAUC,EAAMC,GACnC5D,EAAK6D,OAAO9D,EAAI+D,KAAMH,GACtB3D,EAAK6D,OAAO9D,EAAIgE,KAAMH,IAGxB7B,EAAQ7B,YAAc,SAAU8C,GAC9B,GAAIhD,EAAKE,YAAY8C,IAAYgB,SAASC,cAAc9B,MAAO,CAC7D,IAAM+B,EAAWlE,EAAKmE,KAAK,WACvBD,GAAUlE,EAAKoE,QAAQF,GAC3B,IAAMG,EAAarE,EAAKqD,OAAO,OAAQ,UAAW,UAClDL,EAAQsB,WAAWC,aAAaF,EAAYrB,GAC5CwB,YAAW,WACTH,EAAWI,QAAS,IACnB,Q,mBCvEK3E,EAAQ,IAkBhB4E,OAAOC,IAAM,wBAhBjB,WACE,GAAIC,aAAaC,OAAQ,OAAOD,aAAaC,OAO7C,IALA,IAAIC,EACF,iEAGEC,EAAO,GACFC,EAAI,EAAGA,EAHL,GAGeA,IACxBD,GAAQD,EAASG,OAAOC,KAAKC,MAAMD,KAAKE,SAAWN,EAASO,SAI9D,OADAT,aAAaC,OAASE,EACfA,EAGkCF,I,qCCrBrCd,EAAO/B,EAEPnC,EAAYC,EAAQ,IACpBwF,EAAazF,EAAUyF,WACvBvF,EAAMD,EAAQ,IACdyF,EAAMzF,EAAQ,GACdE,EAAOF,EAAQ,GACf0F,EAAS1F,EAAQ,IACf2F,EAAY3F,EAAQ,GAApB2F,QAEFC,EAAiB5F,EAAQ,IACzB6F,EAAM7F,EAAQ,I,EAUhBA,EAAQ,IAPVmC,E,EAAAA,aACAI,E,EAAAA,cACAC,E,EAAAA,aACAO,E,EAAAA,YACAC,E,EAAAA,WACAC,E,EAAAA,QACAQ,E,EAAAA,OAIFQ,EAAKpC,KAAO,WAaV,IAAK,IAAIiE,KAXJD,EAAInF,OAAOR,EAAKsD,QAAQvD,EAAI8F,uBAAwB,kBAGzDH,EAAeI,MAAMC,SAAQ,SAAAC,GAAK,OAAIhG,EAAK6D,OAAO9D,EAAI2F,eAAgBM,MACtEjG,EAAI2F,eAAevD,MAAQwD,EAAIM,cAAcC,KAGzCP,EAAIQ,WAAUpG,EAAIqG,oBAAoBC,SAAU,GAChDV,EAAIW,QAAQC,EAASC,SAGT5B,aACd,GAAyB,aAArBgB,EAAIa,OAAO,EAAG,GAAmB,CACnC,IAAMC,EAAKd,EAAIa,OAAO,GAChBE,EAAa9G,EAAU+G,QAAQC,kBAAkBH,GACvD7G,EAAUiH,OAAOC,aAAaL,EAAI9B,aAAagB,GAAMe,KAK3D5C,EAAKrC,QAAL,UAAe,4EACTiE,EAAInF,MAAOmF,EAAIqB,WAAa,IAAI1B,EAAWK,EAAInF,OAC9CmF,EAAIqB,WAAa,CAAEC,MAAO,IAC/BC,EAAgBvF,OAChBwF,EAAcxF,OACVgE,EAAIqB,WAAWxG,OAAO4G,EAAc1F,UAL3B,2CAYf,IAAM0F,EAAgB,CAEtBA,QAAwB,WACtB,IAAIzB,EAAIM,cAAcoB,YAAe1B,EAAI2B,UAMzC,IAAI3B,EAAIM,cAAcsB,cAChBxH,EAAIyH,cAAcnB,SAAaV,EAAI8B,SAAY9B,EAAI+B,QADzD,CAOA7H,EAAUiH,OAAOa,OAAShC,EAAI2B,UAC9BzH,EAAUiH,OAAOY,QAAU/B,EAAI+B,QAE/B,IAAME,EAAkBjC,EAAIkC,YAAclC,EAAIM,cAAc6B,OAC1DnC,EAAIqB,YAGNrB,EAAIkC,YACDE,MAAK,SAAU5F,GACVwD,EAAIkC,cAAgBD,GAAiBT,EAAczF,QAAQS,MAFnE,OAIS,WACDwD,EAAIkC,cAAgBD,GACtBT,EAAca,MAAMrC,EAAIqB,WAAWiB,gBAlBrCd,EAAca,MAAM,0CAPjBrC,EAAIM,cAAciC,cACrBf,EAAca,MAAM,iCAgCpBd,EAAkB,CAExBA,KAAuB,WACrBnE,EAAQhD,EAAIoI,cAAe,IAC3BxC,EAAIM,cAAgBP,EAAe3F,EAAI2F,eAAevD,OACtDyC,aAAaqB,cAAgBN,EAAIM,cAAcC,KAE3CP,EAAIM,cAAcoB,WAAYe,EAAUzG,OACvCyG,EAAUC,UACX1C,EAAIM,cAAcsB,YAAae,EAAU3G,OACxC2G,EAAUD,UAEX1C,EAAIM,cAAcvE,SAASiE,EAAIM,cAAcvE,QAAQqC,EAAKrC,WAM1D0G,EAAY,CAElBA,QAAoB,WAClBpI,EAAKyD,KAAK1D,EAAIwI,YACd5C,EAAI2B,eAAY5E,IAGlB0F,EAAUzG,KAAV,UAAiB,uFACf3B,EAAKc,KAAKf,EAAIwI,YAET5C,EAAIM,cAAciC,aAHR,gBAITvC,EAAIqB,WAAWC,MAAMU,OACnBhC,EAAIqB,WAAWC,MAAMU,OAAOK,MAC9BlF,EAAW/C,EAAIyI,aAAc7C,EAAIqB,WAAWC,MAAMU,OAAOK,MAAM9E,UAE/DyC,EAAI2B,WAAY,EAChBzE,EAAY9C,EAAIyI,aAAc7C,EAAIqB,WAAWC,MAAMU,UAGrDhC,EAAI2B,UAAY1C,aAAa0C,UAC7BhF,EACEvC,EAAIyI,aACJ,6BACA7C,EAAI2B,YAhBK,8BAoBb3B,EAAI2B,eAAY5E,EAChBI,EAAW/C,EAAIyI,aAAc,iBAEvBvC,EAAgBN,EAAIM,cAvBb,mBAyBaN,EAAIM,cAAciC,eAzB/B,WAyBLZ,EAzBK,OA0BP3B,EAAIM,gBAAkBA,EA1Bf,mDA2BXN,EAAI2B,UAAYA,EAChBzE,EAAY9C,EAAIyI,aAAclB,GAC9BF,EAAc1F,UA7BH,qDA+BPiE,EAAIM,gBAAkBA,EA/Bf,mDAgCXlG,EAAIyI,aAAahG,YAAc,QAC/BO,EAAQhD,EAAIoI,cAAe,QAAS,KAAMjF,QAAU,KACpDuF,QAAQT,MAAR,MAlCW,0DA0CjB,IAAMM,EAAY,CAElBA,QAAoB,WAClBtI,EAAKyD,KAAK1D,EAAI2I,YACd/C,EAAI+B,QAAU,SACd/B,EAAI8B,aAAU/E,GAGhB4F,KAAiB,WAMf,OALAtI,EAAKc,KAAKf,EAAI2I,YACd1I,EAAKyD,KAAK1D,EAAI4I,oBACdhD,EAAI+B,QAAU/B,EAAIqB,WAAWC,MAAMS,SAAW9C,aAAagE,gBAC3DjD,EAAI8B,aAAU/E,EAENiD,EAAI+B,SACZ,UAAKhF,EACL,IAAK,SACH3C,EAAI8I,cAAcxC,SAAU,EAC5BtG,EAAI6I,gBAAgBE,WAAa,EACjC,MACF,IAAK,OACH/I,EAAIgJ,YAAY1C,SAAU,EAC1B,MACF,QACMtG,EAAI6I,gBAAgBI,UAAUjJ,EAAI6I,gBAAgBI,WAEtDvD,EAAQ,GAAGsC,MAAK,kBAAMhI,EAAI6I,gBAAgBE,WAAa,OACvD/I,EAAIyH,cAAcnB,SAAU,EAE5BrG,EAAKc,KAAKf,EAAI4I,oBACThD,EAAI+B,UAAS/B,EAAI+B,QAAU9C,aAAaqE,kBAC7CtD,EAAI8B,QACA5H,EAAU+G,QAAQa,QAAQ9B,EAAI+B,SAAW,KACtC/B,EAAIqB,WAAWC,MAAMQ,QAC5B1H,EAAIkJ,iBAAiB9G,MAAQwD,EAAI+B,SAAW,GAC5C3H,EAAImJ,cAAc/G,MAAQwD,EAAI8B,SAAW,GAGvC9B,EAAIqB,WAAWC,MAAMS,SAASY,EAAUa,QAG9Cb,KAAiB,WACfzF,EAAY9C,EAAIkJ,kBAChBlJ,EAAI8I,cAAczG,UAAW,EAC7BrC,EAAIgJ,YAAY3G,UAAW,EAC3BrC,EAAIyH,cAAcpF,UAAW,GAG/BkG,OAAmB,SAAUc,GAC3BxE,aAAagE,gBAAkBQ,EAC/BrF,EAAKrC,YAOP3B,EAAI2F,eAAe2D,SAAW,WACxB1D,EAAIM,eAAiBN,EAAIM,cAAcqD,QAAQ3D,EAAIM,cAAcqD,SACrE3D,EAAIQ,SAAWvB,aAAauB,UAAW,EACvCpG,EAAIqG,oBAAoBC,SAAU,EAClCtC,EAAKrC,WAGP3B,EAAIyI,aAAaa,SAAW,WAC1B1D,EAAI2B,UAAY1C,aAAa0C,UAAYvH,EAAIyI,aAAarG,MAC1D4B,EAAKrC,WAGP3B,EAAI6I,gBAAgBI,SAAW,WAC7BjJ,EAAI6I,gBAAgBjG,MAAM4G,aAAe,UACzCxJ,EAAI6I,gBAAgBI,cAAWtG,GAGjC3C,EAAI8I,cAAcQ,SAAW,kBAAMf,EAAS,OAAQ,WACpDvI,EAAIgJ,YAAYM,SAAW,kBAAMf,EAAS,OAAQ,SAClDvI,EAAIyH,cAAc6B,SAAW,kBAAMf,EAAS,OAAQ,KAEpDvI,EAAIkJ,iBAAiBI,SAAW,WAC9B,IAAMG,EAAc3J,EAAU+G,QAAQ4C,YAAYzJ,EAAIkJ,iBAAiB9G,OACvEyC,aAAaqE,iBAAmBO,EAChClB,EAAS,OAAQ,KAGnBvI,EAAImJ,cAAcG,SAAW,WAK3B,GAJA1D,EAAI8B,QAAU1H,EAAImJ,cAAc/G,MAC5BwD,EAAI8B,SAAwC,SAA7B9B,EAAI8B,QAAQhB,OAAO,EAAG,KACvCd,EAAI8B,QAAU,WAAa9B,EAAI8B,SAE7B9B,EAAI+B,SAAW/B,EAAI8B,QAAS,CAC9B,IAAMd,EAAa9G,EAAU+G,QAAQC,kBAAkBlB,EAAI+B,SAC3D7H,EAAUiH,OAAOC,aAAapB,EAAI+B,QAAS/B,EAAI8B,QAASd,GACxD/B,aAAa,WAAa+B,GAAchB,EAAI8B,QAE1C9B,EAAI+B,SAAS3D,EAAKrC,WAOxB,IAAMyF,EAAgB,CAEtBA,KAAqB,WAMnB,GALAA,EAAcpE,QAAQ,IACtBQ,EAAOoC,EAAIM,cAAcwD,YAAa1J,EAAI2J,iBAC1CnG,EAAOoC,EAAIM,cAAc0D,SAAU5J,EAAI6J,cACvCrG,EAAOoC,EAAInF,OAASmF,EAAIM,cAAcK,OAAQvG,EAAI8J,QAE7ClE,EAAInF,MAQHmF,EAAIM,cAAcwD,aAAapH,EAActC,EAAI+J,kBAAmB,KACpEnE,EAAIM,cAAc0D,UAAU7G,EAAW/C,EAAIgK,OAAQ,gBACnDpE,EAAIM,cAAcK,QAAQC,EAASyD,mBATvC,GAAIrE,EAAIM,cAAcgE,IAAK,CAEzBhI,EAAalC,EAAI+J,kBAAmBnE,EAAIM,cAAciE,YADtC,kBAAM/J,SAASc,KAAO0E,EAAIM,cAAcgE,YAGxD9C,EAAca,MAAM,mBAS1Bb,QAAwB,SAAUhF,GAChC,GAAIwD,EAAIM,cAAcwD,YAAa,CAEjCxH,EAAalC,EAAI+J,kBAAmBnE,EAAIM,cAAciE,YADtC,kBAAM/C,EAAcgD,MAAMhI,MAIxCwD,EAAIQ,UAAUpG,EAAI+J,kBAAkBnJ,UAEpCgF,EAAIM,cAAc0D,UAAU9G,EAAY9C,EAAIgK,OAAQ5H,GACpDwD,EAAIM,cAAcK,QAAQC,EAAS7E,QAAQS,IAGjDgF,MAAsB,SAAUa,GAC9B3F,EAActC,EAAI+J,kBAAmB9B,GACrClF,EAAW/C,EAAIgK,OAAQ/B,GACvBhI,EAAKoK,MAAMrK,EAAIuG,UAGjBa,EAAcgD,MAAd,2BAAsB,WAAgBhI,GAAhB,wEACC,iBAAVA,EADS,gBAEdoD,EAAI8E,YAA2C,QAA7B1E,EAAIM,cAAcqE,QACtCC,KAAKpI,EAAO,UACZqI,OAAOC,OAAOC,YAAY,QAAS,MAC1BnF,EAAI8E,YAA2C,aAA7B1E,EAAIM,cAAcqE,QAC7CC,KAAKpI,GACLqI,OAAOC,OAAOC,YAAY,QAAS,MAEnCvK,SAASwK,QAAQxI,GATD,0BAWQ,mBAAVA,EAXE,wBAYlBY,EAAQhD,EAAI6K,kBAAmB,OAAQ,+BACvC7K,EAAI+J,kBAAkB1H,UAAW,EAbf,mBAgBUD,IAhBV,eAgBV0F,EAhBU,iBAiBVV,EAAc0D,gBAAgBhD,GAjBpB,0DAmBhBY,QAAQT,MAAM,KAAM8C,UAAN,MACd3D,EAAcpE,QAAQ,QAAS,KAAMG,QAAQyH,QAAQ,MAAO,KAC5D5K,EAAI+J,kBAAkB1H,UAAW,EArBjB,0DAAtB,sDA0BA+E,EAAc0D,gBAAd,UAAgC,mFAC9B1D,EAAcpE,QAAQ,OAAQ,6BAC9BvB,QAAQC,aAAa,GAAI,GAAIkE,EAAIqB,WAAWxG,OAC5CT,EAAIS,MAAMF,YAAcqF,EAAIqB,WAAWxG,MACvC8H,EAAUa,OAJoB,SAMxBxD,EAAIqB,WAAW+D,OANS,OAO9B5D,EAAcpE,QAAQ,OAAQ,yBAC1BwC,EAAI8E,YAAYI,OAAOC,YAAY,QAAS,KAC5C1G,SAASgH,SACX/I,EAAalC,EAAI+J,kBAAmB,SAAS,kBAAMtI,QAAQyJ,UAE3DlL,EAAI+J,kBAAkB3H,MAAQ,OAZF,2CAgBhCgF,EAAcpE,QAAU,SAAUE,EAAMC,GACtCH,EAAQhD,EAAI6K,kBAAmB3H,EAAMC,IAGvC,IAAMqD,EAAW,CAEjBA,YAAuB,WACrBvG,EAAKsD,QAAQvD,EAAIuG,OAAQtG,EAAKqD,OAAO,SAAU,4BAGjDkD,QAAmB,SAAUpE,GAC3B,GAAKwD,EAAIM,cAAcK,QAAWnE,EAAlC,CAEA,IAAM+I,EAASlL,EAAKqD,OAAO,UAC3BmC,EAAO2F,SAASD,EAAQ/I,EAAO,CAAEiJ,OAAQ,EAAGC,MAAO,IACnDH,EAAOI,MAAQnJ,EACfnC,EAAKsD,QAAQvD,EAAIuG,OAAQ4E,KAG3B3E,OAAkB,WAChBZ,EAAIW,OAAS1B,aAAa2G,IAAM5F,EAAIW,OAChCX,EAAIW,OAAQC,EAASC,SACpBD,EAAS8B,WAGhB9B,OAAkB,WAChBxG,EAAIyL,SAASC,UAAY,UACzBzL,EAAKc,KAAKf,EAAIuG,SAGhBC,QAAmB,WACjBxG,EAAIyL,SAASC,eAAY/I,EACzB1C,EAAKyD,KAAK1D,EAAIuG,UAOhBvG,EAAI+J,kBAAkBnJ,QAAUwG,EAAcgD,MAC9CpK,EAAIyL,SAAS7K,QAAU4F,EAAQ,OAE/BxG,EAAIqG,oBAAoBiD,SAAW,WACjC1D,EAAIQ,SAAWvB,aAAauB,UAAYR,EAAIQ","file":"app.js","sourcesContent":["\"use_strict\"\n/**\n * Cosmic.Link Graphical User Interface\n */\nconst cosmicLib = require(\"cosmic-lib\")\nconst dom = require(\"@cosmic-plus/domutils/es5/dom\")\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\nconst Page = require(\"@cosmic-plus/domutils/es5/page\")\n\nconst { copyContent } = require(\"./helpers\")\n\n// Header\nif (location.origin === \"null\") dom.websiteUrl.textContent = location.pathname\nelse dom.websiteUrl.textContent = location.origin + location.pathname\ndom.query.textContent = location.search\ndom.header.onclick = () => copyContent(dom.header)\n\n// Robot tamper\nrequire(\"./tamper\")\n\n// SEP-0007\nif (cosmicLib.sep7Utils.isWebHandlerSupported()) {\n  html.show(dom.registerSep7Handler)\n  dom.registerSep7Handler.onclick = () => {\n    cosmicLib.sep7Utils.registerWebHandler(\n      location.href.split(/[?#]/, 1)[0],\n      \"Cosmic.link\"\n    )\n  }\n}\n\n// Signing interface\nconst signingUI = require(\"./signing-ui\")\nconst signingPage = Page.add(\"Sign\", dom.sign)\nsigningPage.onSelect = function () {\n  history.replaceState(\"\", null, location.pathname + location.search)\n  signingUI.refresh()\n}\n\nsigningUI.init()\n\n// About page\nPage.add(\"Help\", dom.help)\n\n// Default page\nif (Page.current === signingPage) signingPage.onSelect()\nelse if (!Page.current) Page.select(\"#sign\")\n","\"use_strict\"\n/**\n * Generic helpers\n */\nconst helpers = exports\n\nconst dom = require(\"@cosmic-plus/domutils/es5/dom\")\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\n\n/*******************************************************************************\n * Form Elements Helpers\n */\n\nhelpers.enableButton = function (button, value, onclick) {\n  if (typeof value === \"string\") button.value = value\n  button.onclick = onclick\n  button.disabled = false\n}\n\nhelpers.disableButton = function (button, value) {\n  if (typeof value === \"string\") button.value = value\n  button.disabled = true\n}\n\nhelpers.readWriteBox = function (box, placeholder, value) {\n  if (typeof value === \"string\") box.value = value\n  if (typeof placeholder === \"string\") box.placeholder = placeholder\n  box.disabled = false\n  box.readOnly = false\n  box.onclick = undefined\n  box.style.cursor = \"initial\"\n}\n\nhelpers.readOnlyBox = function (box, value) {\n  if (typeof value === \"string\") box.value = value\n  box.disabled = false\n  box.readOnly = true\n  box.onclick = () => helpers.copyContent(box)\n  box.style.cursor = \"pointer\"\n}\n\nhelpers.disableBox = function (box, placeholder) {\n  helpers.readWriteBox(box, placeholder, \"\")\n  box.disabled = true\n}\n\n/*******************************************************************************\n * Other Helpers\n */\n\nhelpers.display = function (element, type = \"\", message = \"\") {\n  const classname = type ? \".\" + type : null\n  const messageNode = classname\n    ? html.create(\"span\", classname, message)\n    : message\n  html.rewrite(element, html.create(\"span\", classname, messageNode))\n}\n\nhelpers.showIf = function (flag, element) {\n  flag ? html.show(element) : html.hide(element)\n}\n\nhelpers.switchPage = function (from, to) {\n  html.append(dom.body, from)\n  html.append(dom.main, to)\n}\n\nhelpers.copyContent = function (element) {\n  if (html.copyContent(element) && document.activeElement.value) {\n    const prevNode = html.grab(\"#copied\")\n    if (prevNode) html.destroy(prevNode)\n    const copiedNode = html.create(\"span\", \"#copied\", \"Copied\")\n    element.parentNode.insertBefore(copiedNode, element)\n    setTimeout(() => {\n      copiedNode.hidden = true\n    }, 3000)\n  }\n}\n","\"use_strict\"\n/**\n * Robot tamper.\n */\nconst dom = require(\"@cosmic-plus/domutils/es5/dom\")\n\nfunction myHash () {\n  if (localStorage.myHash) return localStorage.myHash\n\n  var alphabet =\n    \"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\"\n  var size = 32\n\n  var hash = \"\"\n  for (var i = 0; i < size; i++) {\n    hash += alphabet.charAt(Math.floor(Math.random() * alphabet.length))\n  }\n\n  localStorage.myHash = hash\n  return hash\n}\n\ndom.tamper.src = \"https://robohash.org/\" + myHash()\n","\"use_strict\"\nconst main = exports\n\nconst cosmicLib = require(\"cosmic-lib\")\nconst CosmicLink = cosmicLib.CosmicLink\nconst dom = require(\"@cosmic-plus/domutils/es5/dom\")\nconst env = require(\"@cosmic-plus/jsutils/es5/env\")\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\nconst QrCode = require(\"qrcode\")\nconst { timeout } = require(\"@cosmic-plus/jsutils/es5/misc\")\n\nconst authenticators = require(\"./authenticators\")\nconst the = require(\"./shared\")\n\nconst {\n  enableButton,\n  disableButton,\n  readWriteBox,\n  readOnlyBox,\n  disableBox,\n  display,\n  showIf\n} = require(\"./helpers\")\n\n// Run once page is fully loaded\nmain.init = function () {\n  // Step 1: Transaction\n  if (!the.query) html.rewrite(dom.cosmiclink_description, \"No transaction\")\n\n  // Step 2: Authenticator\n  authenticators.nodes.forEach(entry => html.append(dom.authenticators, entry))\n  dom.authenticators.value = the.authenticator.name\n\n  // Step 3: Signing\n  if (the.redirect) dom.redirectionCheckbox.checked = true\n  if (the.qrCode) qrCodeUI.enable()\n\n  // CosmicLib network setup\n  for (let key in localStorage) {\n    if (key.substr(0, 8) === \"network:\") {\n      const id = key.substr(8)\n      const passphrase = cosmicLib.resolve.networkPassphrase(id)\n      cosmicLib.config.setupNetwork(id, localStorage[key], passphrase)\n    }\n  }\n}\n\nmain.refresh = async function () {\n  if (the.query) the.cosmicLink = new CosmicLink(the.query)\n  else the.cosmicLink = { tdesc: {} }\n  authenticatorUI.init()\n  redirectionUI.init()\n  if (the.cosmicLink.query) transactionUI.refresh()\n}\n\n/*******************************************************************************\n * Step 1: Transaction UI\n */\n\nconst transactionUI = {}\n\ntransactionUI.refresh = function () {\n  if (the.authenticator.needSource && !the.accountId) {\n    if (!the.authenticator.getAccountId) {\n      redirectionUI.error(\"Please set a source account\")\n    }\n    return\n  }\n  if (the.authenticator.needNetwork) {\n    if (dom.customNetwork.checked && (!the.horizon || !the.network)) {\n      redirectionUI.error(\"Please fill custom network fields\")\n      return\n    }\n  }\n\n  cosmicLib.config.source = the.accountId\n  cosmicLib.config.network = the.network\n\n  const saveTransaction = the.transaction = the.authenticator.handle(\n    the.cosmicLink\n  )\n\n  the.transaction\n    .then(function (value) {\n      if (the.transaction === saveTransaction) redirectionUI.refresh(value)\n    })\n    .catch(function () {\n      if (the.transaction === saveTransaction)\n        redirectionUI.error(the.cosmicLink.status)\n    })\n}\n\n/*******************************************************************************\n * Step 2: Authenticator UI\n */\n\nconst authenticatorUI = {}\n\nauthenticatorUI.init = function () {\n  display(dom.accountMsgbox, \"\")\n  the.authenticator = authenticators[dom.authenticators.value]\n  localStorage.authenticator = the.authenticator.name\n\n  if (the.authenticator.needSource) accountUI.init()\n  else accountUI.disable()\n  if (the.authenticator.needNetwork) networkUI.init()\n  else networkUI.disable()\n\n  if (the.authenticator.refresh) the.authenticator.refresh(main.refresh)\n}\n\n/**\n * AccountID box UI\n */\nconst accountUI = {}\n\naccountUI.disable = function () {\n  html.hide(dom.accountDiv)\n  the.accountId = undefined\n}\n\naccountUI.init = async function () {\n  html.show(dom.accountDiv)\n\n  if (!the.authenticator.getAccountId) {\n    if (the.cosmicLink.tdesc.source) {\n      if (the.cosmicLink.tdesc.source.error) {\n        disableBox(dom.accountIdBox, the.cosmicLink.tdesc.source.error.message)\n      } else {\n        the.accountId = true\n        readOnlyBox(dom.accountIdBox, the.cosmicLink.tdesc.source)\n      }\n    } else {\n      the.accountId = localStorage.accountId\n      readWriteBox(\n        dom.accountIdBox,\n        \"Your Account Address or ID\",\n        the.accountId\n      )\n    }\n  } else {\n    the.accountId = undefined\n    disableBox(dom.accountIdBox, \"Connecting...\")\n\n    const authenticator = the.authenticator\n    try {\n      const accountId = await the.authenticator.getAccountId()\n      if (the.authenticator !== authenticator) return\n      the.accountId = accountId\n      readOnlyBox(dom.accountIdBox, accountId)\n      transactionUI.refresh()\n    } catch (error) {\n      if (the.authenticator !== authenticator) return\n      dom.accountIdBox.placeholder = \"Error\"\n      display(dom.accountMsgbox, \"error\", error.message + \".\")\n      console.error(error)\n    }\n  }\n}\n\n/**\n * Network selection UI\n */\nconst networkUI = {}\n\nnetworkUI.disable = function () {\n  html.hide(dom.networkDiv)\n  the.network = \"public\"\n  the.horizon = undefined\n}\n\nnetworkUI.init = function () {\n  html.show(dom.networkDiv)\n  html.hide(dom.customNetworkSetup)\n  the.network = the.cosmicLink.tdesc.network || localStorage.networkSelector\n  the.horizon = undefined\n\n  switch (the.network) {\n  case undefined:\n  case \"public\":\n    dom.publicNetwork.checked = true\n    dom.networkSelector.scrollLeft = 0\n    break\n  case \"test\":\n    dom.testNetwork.checked = true\n    break\n  default:\n    if (dom.networkSelector.onscroll) dom.networkSelector.onscroll()\n    // Doesn't works when called synchronously.\n    timeout(1).then(() => dom.networkSelector.scrollLeft = 999)\n    dom.customNetwork.checked = true\n\n    html.show(dom.customNetworkSetup)\n    if (!the.network) the.network = localStorage.customPassphrase\n    the.horizon =\n        cosmicLib.resolve.horizon(the.network || \"\")\n        || the.cosmicLink.tdesc.horizon\n    dom.customPassphrase.value = the.network || \"\"\n    dom.customHorizon.value = the.horizon || \"\"\n  }\n\n  if (the.cosmicLink.tdesc.network) networkUI.lock()\n}\n\nnetworkUI.lock = function () {\n  readOnlyBox(dom.customPassphrase)\n  dom.publicNetwork.disabled = true\n  dom.testNetwork.disabled = true\n  dom.customNetwork.disabled = true\n}\n\nnetworkUI.switch = function (selector) {\n  localStorage.networkSelector = selector\n  main.refresh()\n}\n\n/**\n * HTML Elements Events\n */\n\ndom.authenticators.onchange = function () {\n  if (the.authenticator && the.authenticator.onExit) the.authenticator.onExit()\n  the.redirect = localStorage.redirect = false\n  dom.redirectionCheckbox.checked = false\n  main.refresh()\n}\n\ndom.accountIdBox.onchange = function () {\n  the.accountId = localStorage.accountId = dom.accountIdBox.value\n  main.refresh()\n}\n\ndom.networkSelector.onscroll = function () {\n  dom.networkSelector.style.textOverflow = \"initial\"\n  dom.networkSelector.onscroll = undefined\n}\n\ndom.publicNetwork.onchange = () => networkUI.switch(\"public\")\ndom.testNetwork.onchange = () => networkUI.switch(\"test\")\ndom.customNetwork.onchange = () => networkUI.switch(\"\")\n\ndom.customPassphrase.onchange = function () {\n  const networkName = cosmicLib.resolve.networkName(dom.customPassphrase.value)\n  localStorage.customPassphrase = networkName\n  networkUI.switch(\"\")\n}\n\ndom.customHorizon.onchange = function () {\n  the.horizon = dom.customHorizon.value\n  if (the.horizon && the.horizon.substr(0, 4) !== \"http\") {\n    the.horizon = \"https://\" + the.horizon\n  }\n  if (the.network && the.horizon) {\n    const passphrase = cosmicLib.resolve.networkPassphrase(the.network)\n    cosmicLib.config.setupNetwork(the.network, the.horizon, passphrase)\n    localStorage[\"network:\" + passphrase] = the.horizon\n  }\n  if (the.network) main.refresh()\n}\n\n/*******************************************************************************\n * Step 3: Signing/Redirection UI\n */\n\nconst redirectionUI = {}\n\nredirectionUI.init = function () {\n  redirectionUI.display(\"\")\n  showIf(the.authenticator.redirection, dom.redirectionForm)\n  showIf(the.authenticator.textarea, dom.textareaForm)\n  showIf(the.query && the.authenticator.qrCode, dom.qrForm)\n\n  if (!the.query) {\n    if (the.authenticator.url) {\n      const onclick = () => location.href = the.authenticator.url\n      enableButton(dom.redirectionButton, the.authenticator.buttonText, onclick)\n    } else {\n      redirectionUI.error(\"No transaction\")\n    }\n  } else {\n    if (the.authenticator.redirection) disableButton(dom.redirectionButton, \"…\")\n    if (the.authenticator.textarea) disableBox(dom.xdrBox, \"Computing...\")\n    if (the.authenticator.qrCode) qrCodeUI.loadingAnim()\n  }\n}\n\nredirectionUI.refresh = function (value) {\n  if (the.authenticator.redirection) {\n    const onclick = () => redirectionUI.click(value)\n    enableButton(dom.redirectionButton, the.authenticator.buttonText, onclick)\n  }\n\n  if (the.redirect) dom.redirectionButton.onclick()\n\n  if (the.authenticator.textarea) readOnlyBox(dom.xdrBox, value)\n  if (the.authenticator.qrCode) qrCodeUI.refresh(value)\n}\n\nredirectionUI.error = function (error) {\n  disableButton(dom.redirectionButton, error)\n  disableBox(dom.xdrBox, error)\n  html.clear(dom.qrCode)\n}\n\nredirectionUI.click = async function (value) {\n  if (typeof value === \"string\") {\n    if (env.isEmbedded && the.authenticator.target === \"new\") {\n      open(value, \"_blank\")\n      window.parent.postMessage(\"close\", \"*\")\n    } else if (env.isEmbedded && the.authenticator.target === \"external\") {\n      open(value)\n      window.parent.postMessage(\"close\", \"*\")\n    } else {\n      location.replace(value)\n    }\n  } else if (typeof value === \"function\") {\n    display(dom.redirectionMsgbox, \"info\", \"Waiting for confirmation...\")\n    dom.redirectionButton.disabled = true\n\n    try {\n      const transaction = await value()\n      await redirectionUI.sendTransaction(transaction)\n    } catch (error) {\n      console.error(error.response || error)\n      redirectionUI.display(\"error\", error.message.replace(/\\.$/, \"\"))\n      dom.redirectionButton.disabled = false\n    }\n  }\n}\n\nredirectionUI.sendTransaction = async function () {\n  redirectionUI.display(\"info\", \"Sending to the network...\")\n  history.replaceState({}, \"\", the.cosmicLink.query)\n  dom.query.textContent = the.cosmicLink.query\n  networkUI.lock()\n\n  await the.cosmicLink.send()\n  redirectionUI.display(\"info\", \"Transaction validated\")\n  if (env.isEmbedded) parent.postMessage(\"close\", \"*\")\n  if (document.referrer) {\n    enableButton(dom.redirectionButton, \"Close\", () => history.back())\n  } else {\n    dom.redirectionButton.value = \"Done\"\n  }\n}\n\nredirectionUI.display = function (type, message) {\n  display(dom.redirectionMsgbox, type, message)\n}\n\nconst qrCodeUI = {}\n\nqrCodeUI.loadingAnim = function () {\n  html.rewrite(dom.qrCode, html.create(\"canvas\", \".cosmiclib_loadingAnim\"))\n}\n\nqrCodeUI.refresh = function (value) {\n  if (!the.authenticator.qrCode || !value) return\n\n  const canvas = html.create(\"canvas\")\n  QrCode.toCanvas(canvas, value, { margin: 0, scale: 4 })\n  canvas.title = value\n  html.rewrite(dom.qrCode, canvas)\n}\n\nqrCodeUI.switch = function () {\n  the.qrCode = localStorage.QR = !the.qrCode\n  if (the.qrCode) qrCodeUI.enable()\n  else qrCodeUI.disable()\n}\n\nqrCodeUI.enable = function () {\n  dom.qrButton.className = \"enabled\"\n  html.show(dom.qrCode)\n}\n\nqrCodeUI.disable = function () {\n  dom.qrButton.className = undefined\n  html.hide(dom.qrCode)\n}\n\n/**\n * HTML Elements Events\n */\n\ndom.redirectionButton.onclick = redirectionUI.click\ndom.qrButton.onclick = qrCodeUI.switch\n\ndom.redirectionCheckbox.onchange = function () {\n  the.redirect = localStorage.redirect = !the.redirect\n}\n"],"sourceRoot":""}