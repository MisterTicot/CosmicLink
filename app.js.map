{"version":3,"sources":["webpack:///./src/signing-ui.js","webpack:///./src/view/tx-result-view.js","webpack:///./src/tamper.js","webpack:///./src/app.js","webpack:///./src/app-interface.js","webpack:///./src/helpers.js","webpack:///./src/app-widget.js"],"names":["main","exports","cosmicLib","require","CosmicLink","dom","env","html","QrCode","timeout","TxResultView","authenticators","the","enableButton","disableButton","readWriteBox","readOnlyBox","disableBox","display","showIf","init","key","query","rewrite","cosmiclink_description","nodes","forEach","entry","append","value","authenticator","name","redirect","redirectionCheckbox","checked","qrCode","qrCodeUI","enable","localStorage","substr","id","passphrase","resolve","networkPassphrase","config","setupNetwork","refresh","cosmicLink","tdesc","authenticatorUI","redirectionUI","transactionUI","needSource","accountId","needNetwork","customNetwork","horizon","network","source","saveTransaction","transaction","handle","then","error","status","getAccountId","accountMsgbox","accountUI","disable","networkUI","hide","accountDiv","undefined","show","accountIdBox","message","placeholder","console","networkDiv","customNetworkSetup","networkSelector","publicNetwork","scrollLeft","testNetwork","onscroll","customPassphrase","customHorizon","lock","disabled","selector","onchange","onExit","style","textOverflow","networkName","redirection","redirectionForm","textarea","textareaForm","qrForm","redirectionButton","xdrBox","loadingAnim","url","buttonText","location","href","click","contextIsWidget","onclick","clear","action","isEmbedded","target","open","window","parent","postMessage","replace","redirectionMsgbox","sendTransaction","response","_query","_xdr","history","replaceState","textContent","scrollTo","document","body","scrollHeight","forCosmicLink","result","validated","referrer","back","type","create","canvas","title","scale","Math","max","floor","sqrt","toCanvas","margin","QR","qrButton","className","Gui","TxResult","txResult","Object","assign","state","obj","msg","module","tamper","src","myHash","alphabet","hash","i","charAt","random","length","signingUI","signingPage","Page","copyContent","add","sign","onSelect","pathname","search","origin","websiteUrl","header","about","sep7Utils","isWebHandlerSupported","registerSep7Handler","registerWebHandler","split","current","select","helpers","button","box","readOnly","cursor","element","classname","messageNode","flag","switchPage","from","to","activeElement","prevNode","grab","destroy","copiedNode","parentNode","insertBefore","setTimeout","hidden","load","join","params","parseQuery","csp","content","handler","byId","qrcode","log","keys","loading","css","push","Promise","all","keyval","val","decodeURIComponent","initWidget"],"mappings":"4GACMA,EAAOC,EAEPC,EAAYC,EAAQ,IACpBC,EAAaF,EAAUE,WACvBC,EAAMF,EAAQ,IACdG,EAAMH,EAAQ,GACdI,EAAOJ,EAAQ,GACfK,EAASL,EAAQ,KACfM,EAAYN,EAAQ,GAApBM,QAEFC,EAAeP,EAAQ,KAEvBQ,EAAiBR,EAAQ,IACzBS,EAAMT,EAAQ,G,EAUhBA,EAAQ,IAPVU,E,EAAAA,aACAC,E,EAAAA,cACAC,E,EAAAA,aACAC,E,EAAAA,YACAC,E,EAAAA,WACAC,E,EAAAA,QACAC,E,EAAAA,OAIFnB,EAAKoB,KAAO,WAaV,IAAK,IAAIC,KAXJT,EAAIU,OAAOf,EAAKgB,QAAQlB,EAAImB,uBAAwB,kBAGzDb,EAAec,MAAMC,SAAQ,SAAAC,GAAK,OAAIpB,EAAKqB,OAAOvB,EAAIM,eAAgBgB,MACtEtB,EAAIM,eAAekB,MAAQjB,EAAIkB,cAAcC,KAGzCnB,EAAIoB,WAAU3B,EAAI4B,oBAAoBC,SAAU,GAChDtB,EAAIuB,QAAQC,EAASC,SAGTC,aACd,GAAyB,aAArBjB,EAAIkB,OAAO,EAAG,GAAmB,CACnC,IAAMC,EAAKnB,EAAIkB,OAAO,GAChBE,EAAavC,EAAUwC,QAAQC,kBAAkBH,GACvDtC,EAAU0C,OAAOC,aAAaL,EAAIF,aAAajB,GAAMoB,KAK3DzC,EAAK8C,QAAL,UAAe,4EACTlC,EAAIU,MAAOV,EAAImC,WAAa,IAAI3C,EAAWQ,EAAIU,OAC9CV,EAAImC,WAAa,CAAEC,MAAO,IAC/BC,EAAgB7B,OAChB8B,EAAc9B,OACVR,EAAImC,WAAWzB,OAAO6B,EAAcL,UAL3B,2CAYf,IAAMK,EAAgB,CAEtBA,QAAwB,WACtB,IAAIvC,EAAIkB,cAAcsB,YAAexC,EAAIyC,UAMzC,IAAIzC,EAAIkB,cAAcwB,cAChBjD,EAAIkD,cAAcrB,SAAatB,EAAI4C,SAAY5C,EAAI6C,QADzD,CAOAvD,EAAU0C,OAAOc,OAAS9C,EAAIyC,UAC9BnD,EAAU0C,OAAOa,QAAU7C,EAAI6C,QAE/B,IAAME,EAAkB/C,EAAIgD,YAAchD,EAAIkB,cAAc+B,OAC1DjD,EAAImC,YAGNnC,EAAIgD,YACDE,MAAK,SAAUjC,GACVjB,EAAIgD,cAAgBD,GAAiBT,EAAcJ,QAAQjB,MAFnE,OAIS,WACDjB,EAAIgD,cAAgBD,GACtBT,EAAca,MAAMnD,EAAImC,WAAWiB,gBAlBrCd,EAAca,MAAM,0CAPjBnD,EAAIkB,cAAcmC,cACrBf,EAAca,MAAM,iCAgCpBd,EAAkB,CAExBA,KAAuB,WACrB/B,EAAQb,EAAI6D,cAAe,IAC3BtD,EAAIkB,cAAgBnB,EAAeN,EAAIM,eAAekB,OACtDS,aAAaR,cAAgBlB,EAAIkB,cAAcC,KAE3CnB,EAAIkB,cAAcsB,WAAYe,EAAU/C,OACvC+C,EAAUC,UACXxD,EAAIkB,cAAcwB,YAAae,EAAUjD,OACxCiD,EAAUD,UAEXxD,EAAIkB,cAAcgB,SAASlC,EAAIkB,cAAcgB,QAAQ9C,EAAK8C,WAM1DqB,EAAY,CAElBA,QAAoB,WAClB5D,EAAK+D,KAAKjE,EAAIkE,YACd3D,EAAIyC,eAAYmB,IAGlBL,EAAU/C,KAAV,UAAiB,uFACfb,EAAKkE,KAAKpE,EAAIkE,YAET3D,EAAIkB,cAAcmC,aAHR,gBAITrD,EAAImC,WAAWC,MAAMU,OACnB9C,EAAImC,WAAWC,MAAMU,OAAOK,MAC9B9C,EAAWZ,EAAIqE,aAAc9D,EAAImC,WAAWC,MAAMU,OAAOK,MAAMY,UAE/D/D,EAAIyC,WAAY,EAChBrC,EAAYX,EAAIqE,aAAc9D,EAAImC,WAAWC,MAAMU,UAGrD9C,EAAIyC,UAAYf,aAAae,UAC7BtC,EACEV,EAAIqE,aACJ,kCACA9D,EAAIyC,YAhBK,8BAoBbzC,EAAIyC,eAAYmB,EAChBvD,EAAWZ,EAAIqE,aAAc,iBAEvB5C,EAAgBlB,EAAIkB,cAvBb,mBAyBalB,EAAIkB,cAAcmC,eAzB/B,WAyBLZ,EAzBK,OA0BPzC,EAAIkB,gBAAkBA,EA1Bf,mDA2BXlB,EAAIyC,UAAYA,EAChBrC,EAAYX,EAAIqE,aAAcrB,GAC9BF,EAAcL,UA7BH,qDA+BPlC,EAAIkB,gBAAkBA,EA/Bf,mDAgCXzB,EAAIqE,aAAaE,YAAc,QAC/B1D,EAAQb,EAAI6D,cAAe,QAAS,KAAMS,QAAU,KACpDE,QAAQd,MAAR,MAlCW,0DA0CjB,IAAMM,EAAY,CAElBA,QAAoB,WAClB9D,EAAK+D,KAAKjE,EAAIyE,YACdlE,EAAI6C,QAAU,SACd7C,EAAI4C,aAAUgB,GAGhBH,KAAiB,WAOf,OANA9D,EAAKkE,KAAKpE,EAAIyE,YACdvE,EAAK+D,KAAKjE,EAAI0E,oBACdnE,EAAI6C,QACF7C,EAAImC,WAAWC,MAAMS,SAAWnB,aAAa0C,iBAAmB,SAClEpE,EAAI4C,aAAUgB,EAEN5D,EAAI6C,SACZ,UAAKe,EACL,IAAK,SACHnE,EAAI4E,cAAc/C,SAAU,EAC5B7B,EAAI2E,gBAAgBE,WAAa,EACjC,MACF,IAAK,OACH7E,EAAI8E,YAAYjD,SAAU,EAC1B,MACF,QACM7B,EAAI2E,gBAAgBI,UAAU/E,EAAI2E,gBAAgBI,WAEtD3E,EAAQ,GAAGqD,MAAK,kBAAMzD,EAAI2E,gBAAgBE,WAAa,OACvD7E,EAAIkD,cAAcrB,SAAU,EAE5B3B,EAAKkE,KAAKpE,EAAI0E,oBACTnE,EAAI6C,UAAS7C,EAAI6C,QAAUnB,aAAa+C,kBAC7CzE,EAAI4C,QACAtD,EAAUwC,QAAQc,QAAQ5C,EAAI6C,SAAW,KACtC7C,EAAImC,WAAWC,MAAMQ,QAC5BnD,EAAIgF,iBAAiBxD,MAAQjB,EAAI6C,SAAW,GAC5CpD,EAAIiF,cAAczD,MAAQjB,EAAI4C,SAAW,GAGvC5C,EAAImC,WAAWC,MAAMS,SAASY,EAAUkB,QAG9ClB,KAAiB,WACfrD,EAAYX,EAAIgF,kBAChBhF,EAAI4E,cAAcO,UAAW,EAC7BnF,EAAI8E,YAAYK,UAAW,EAC3BnF,EAAIkD,cAAciC,UAAW,GAG/BnB,OAAmB,SAAUoB,GAC3BnD,aAAa0C,gBAAkBS,EAC/BzF,EAAK8C,YAOPzC,EAAIM,eAAe+E,SAAW,WACxB9E,EAAIkB,eAAiBlB,EAAIkB,cAAc6D,QAAQ/E,EAAIkB,cAAc6D,SACrE/E,EAAIoB,SAAWM,aAAaN,UAAW,EACvC3B,EAAI4B,oBAAoBC,SAAU,EAClClC,EAAK8C,WAGPzC,EAAIqE,aAAagB,SAAW,WAC1B9E,EAAIyC,UAAYf,aAAae,UAAYhD,EAAIqE,aAAa7C,MAC1D7B,EAAK8C,WAGPzC,EAAI2E,gBAAgBI,SAAW,WAC7B/E,EAAI2E,gBAAgBY,MAAMC,aAAe,UACzCxF,EAAI2E,gBAAgBI,cAAWZ,GAGjCnE,EAAI4E,cAAcS,SAAW,kBAAMrB,EAAS,OAAQ,WACpDhE,EAAI8E,YAAYO,SAAW,kBAAMrB,EAAS,OAAQ,SAClDhE,EAAIkD,cAAcmC,SAAW,kBAAMrB,EAAS,OAAQ,KAEpDhE,EAAIgF,iBAAiBK,SAAW,WAC9B,IAAMI,EAAc5F,EAAUwC,QAAQoD,YAAYzF,EAAIgF,iBAAiBxD,OACvES,aAAa+C,iBAAmBS,EAChCzB,EAAS,OAAQ,KAGnBhE,EAAIiF,cAAcI,SAAW,WAK3B,GAJA9E,EAAI4C,QAAUnD,EAAIiF,cAAczD,MAC5BjB,EAAI4C,SAAwC,SAA7B5C,EAAI4C,QAAQjB,OAAO,EAAG,KACvC3B,EAAI4C,QAAU,WAAa5C,EAAI4C,SAE7B5C,EAAI6C,SAAW7C,EAAI4C,QAAS,CAC9B,IAAMf,EAAavC,EAAUwC,QAAQC,kBAAkB/B,EAAI6C,SAC3DvD,EAAU0C,OAAOC,aAAajC,EAAI6C,QAAS7C,EAAI4C,QAASf,GACxDH,aAAa,WAAaG,GAAc7B,EAAI4C,QAE1C5C,EAAI6C,SAASzD,EAAK8C,WAOxB,IAAMI,EAAgB,CAEtBA,KAAqB,WAMnB,GALAA,EAAchC,QAAQ,IACtBC,EAAOP,EAAIkB,cAAciE,YAAa1F,EAAI2F,iBAC1C7E,EAAOP,EAAIkB,cAAcmE,SAAU5F,EAAI6F,cACvC/E,EAAOP,EAAIU,OAASV,EAAIkB,cAAcK,OAAQ9B,EAAI8F,QAE7CvF,EAAIU,MAQHV,EAAIkB,cAAciE,aAAajF,EAAcT,EAAI+F,kBAAmB,KACpExF,EAAIkB,cAAcmE,UAAUhF,EAAWZ,EAAIgG,OAAQ,gBACnDzF,EAAIkB,cAAcK,QAAQC,EAASkE,mBATvC,GAAI1F,EAAIkB,cAAcyE,IAAK,CAEzB1F,EAAaR,EAAI+F,kBAAmBxF,EAAIkB,cAAc0E,YADtC,kBAAMC,SAASC,KAAO9F,EAAIkB,cAAcyE,YAGxDrD,EAAca,MAAM,mBAS1Bb,QAAwB,SAAUrB,GAChC,GAAIjB,EAAIkB,cAAciE,YAAa,CAEjClF,EAAaR,EAAI+F,kBAAmBxF,EAAIkB,cAAc0E,YADtC,kBAAMtD,EAAcyD,MAAM9E,MAIxCjB,EAAIoB,WAAapB,EAAIgG,iBACvBvG,EAAI+F,kBAAkBS,UAGpBjG,EAAIkB,cAAcmE,UAAUjF,EAAYX,EAAIgG,OAAQxE,GACpDjB,EAAIkB,cAAcK,QAAQC,EAASU,QAAQjB,IAGjDqB,MAAsB,SAAUa,GAC9BjD,EAAcT,EAAI+F,kBAAmBrC,GACrC9C,EAAWZ,EAAIgG,OAAQtC,GACvBxD,EAAKuG,MAAMzG,EAAI8B,UAGjBe,EAAcyD,MAAd,2BAAsB,WAAgBI,GAAhB,wEACE,iBAAXA,EADS,gBAGhBnG,EAAIgG,iBACDtG,EAAI0G,YAA2C,QAA7BpG,EAAIkB,cAAcmF,QAEvCC,KAAKH,EAAQ,UACbI,OAAOC,OAAOC,YAAY,QAAS,MAC1B/G,EAAI0G,YAA2C,aAA7BpG,EAAIkB,cAAcmF,QAC7CC,KAAKH,GACLI,OAAOC,OAAOC,YAAY,QAAS,MAEnCZ,SAASa,QAAQP,GAZD,0BAcS,mBAAXA,EAdE,wBAelB7F,EAAQb,EAAIkH,kBAAmB,OAAQ,+BACvClH,EAAI+F,kBAAkBZ,UAAW,EAhBf,mBAmBUuB,IAnBV,eAmBVnD,EAnBU,iBAoBVV,EAAcsE,gBAAgB5D,GApBpB,0DAsBhBiB,QAAQd,MAAM,KAAM0D,UAAN,MACdvE,EAAchC,QAAQ,QAAS,KAAMyD,QAAQ2C,QAAQ,MAAO,KAC5DjH,EAAI+F,kBAAkBZ,UAAW,EAxBjB,0DAAtB,sDA6BAtC,EAAcsE,gBAAd,UAAgC,yFAC9BtE,EAAchC,QAAQ,OAAQ,oCAGvBN,EAAImC,WAAW2E,cACf9G,EAAImC,WAAW4E,KACtB/G,EAAIU,MAAQV,EAAImC,WAAWzB,MAE3BsG,QAAQC,aAAa,GAAI,GAAIjH,EAAIU,OACjC+C,EAAUkB,OAGNlF,EAAIiB,QACNjB,EAAIiB,MAAMwG,YAAclH,EAAIU,OAG9B6F,OAAOY,SAAS,EAAGC,SAASC,KAAKC,cAhBH,UAiBTxH,EAAayH,cAAcvH,EAAImC,YAjBtB,QAiBxBqF,EAjBwB,OAkB9BlF,EAAchC,QAAQ,GAAIkH,GAEtBA,EAAOC,WAAa/H,EAAI0G,YAC1BI,OAAOC,YAAY,QAAS,KAE1BW,SAASM,SACXzH,EAAaR,EAAI+F,kBAAmB,SAAS,kBAAMwB,QAAQW,UAE3DlI,EAAI+F,kBAAkBvE,MAAQ,OA1BF,4CA8BhCqB,EAAchC,QAAU,SAAUsH,EAAM7D,GACtCzD,EAAQb,EAAIkH,kBAAmBiB,EAAM7D,IAGvC,IAAMvC,EAAW,CAEjBA,YAAuB,WACrB7B,EAAKgB,QAAQlB,EAAI8B,OAAQ5B,EAAKkI,OAAO,OAAQ,6BAG/CrG,EAASU,QAAT,2BAAmB,WAAgBjB,GAAhB,uFAEXpB,EAAQ,GAFG,UAIZG,EAAIkB,cAAcK,QAAWN,EAJjB,iDAMX6G,EAASnI,EAAKkI,OAAO,SAAU,CAAEE,MAAO9G,IACxC+G,EAAQC,KAAKC,IAAI,EAAG,EAAID,KAAKE,MAAMF,KAAKG,KAAKnH,GAAS,KAC5DrB,EAAOyI,SAASP,EAAQ7G,EAAO,CAAEqH,OAAQ,EAAGN,UAE5CrI,EAAKgB,QAAQlB,EAAI8B,OAAQuG,GAVR,2CAAnB,sDAaAtG,EAAQ,OAAU,WAChBxB,EAAIuB,OAASG,aAAa6G,IAAMvI,EAAIuB,OAChCvB,EAAIuB,OAAQC,EAASC,SACpBD,EAASgC,WAGhBhC,EAASC,OAAS,WAChBhC,EAAI+I,SAASC,UAAY,UACzB9I,EAAKkE,KAAKpE,EAAI8B,SAGhBC,EAASgC,QAAU,WACjB/D,EAAI+I,SAASC,eAAY7E,EACzBjE,EAAK+D,KAAKjE,EAAI8B,SAOhB9B,EAAI+F,kBAAkBS,QAAU3D,EAAcyD,MAC9CtG,EAAI+I,SAASvC,QAAUzE,EAAQ,OAE/B/B,EAAI4B,oBAAoByD,SAAW,WACjC9E,EAAIoB,SAAWM,aAAaN,UAAYpB,EAAIoB,W,2VC3Z9C,IAAMsH,EAAMnJ,EAAQ,KACdI,EAAOJ,EAAQ,GAEfoJ,EAAWpJ,EAAQ,KAGnBO,E,iLAWJ,WAAa8I,GAAU,uBACrB,wLAYAC,OAAOC,OAAP,KAAoBF,GACpB,EAAKG,MAAQ,EAAKtB,UAAY,OAAS,QAdlB,E,oEAVKtF,G,qFACLwG,EAASpB,cAAcpF,G,cAAtCqF,E,yBACC,IAAI1H,EAAa0H,I,4HAGLX,GAEnB,OAAO,IAAI/G,EADI,IAAI6I,EAAS9B,Q,+BAqBzBmC,GACH,QAASA,I,2BAELC,GACJ,OAAOtJ,EAAKkI,OAAO,KAAM,KAAMoB,O,GAhCRP,GAqC3BQ,EAAO7J,QAAUS,G,iCC3CLP,EAAQ,IAkBhB4J,OAAOC,IAAM,wBAhBjB,WACE,GAAI1H,aAAa2H,OAAQ,OAAO3H,aAAa2H,OAO7C,IALA,IAAIC,EACF,iEAGEC,EAAO,GACFC,EAAI,EAAGA,EAHL,GAGeA,IACxBD,GAAQD,EAASG,OAAOxB,KAAKE,MAAMF,KAAKyB,SAAWJ,EAASK,SAI9D,OADAjI,aAAa2H,OAASE,EACfA,EAGkCF,I,gCClB/B9J,EAAQ,GAEZyG,gBACNzG,EAAQ,IAERA,EAAQ,K,gCCLV,IAYQqK,EACAC,EAbFvK,EAAYC,EAAQ,IACpBE,EAAMF,EAAQ,IACdI,EAAOJ,EAAQ,GACfuK,EAAOvK,EAAQ,KAEfS,EAAMT,EAAQ,GACZwK,EAAgBxK,EAAQ,IAAxBwK,YAMAH,EAAYrK,EAAQ,MACpBsK,EAAcC,EAAKE,IAAI,OAAQvK,EAAIwK,OAC7BC,SAAW,WACrBlD,QAAQC,aAAa,GAAI,KAAMpB,SAASsE,SAAWtE,SAASuE,QAC5DR,EAAU1H,WAEZ0H,EAAUpJ,OAGLR,EAAIgG,kBAWe,SAApBH,SAASwE,OACX5K,EAAI6K,WAAWpD,YAAcrB,SAASsE,SAEtC1K,EAAI6K,WAAWpD,YAAcrB,SAASwE,OAASxE,SAASsE,SAE1D1K,EAAIiB,MAAMwG,YAAcrB,SAASuE,OACjC3K,EAAI8K,OAAOtE,QAAU,kBAAM8D,EAAYtK,EAAI8K,SAG3CT,EAAKE,IAAI,QAASvK,EAAI+K,OAGlBlL,EAAUmL,UAAUC,wBACtBjL,EAAIkL,oBAAoB1E,QAAU,WAChC3G,EAAUmL,UAAUG,mBAClB/E,SAASC,KAAK+E,MAAM,OAAQ,GAAG,GAC/B,gBAKJpL,EAAIkL,oBAAoBzD,YAAc,GAExCvH,EAAKkE,KAAKpE,EAAIkL,qBAGdpL,EAAQ,MAhCJuK,EAAKgB,UAAYjB,EAAaA,EAAYK,WACpCJ,EAAKgB,SAAShB,EAAKiB,OAAO,U,gCC3BtC,IAAMC,EAAU3L,EAEVI,EAAMF,EAAQ,IACdI,EAAOJ,EAAQ,GAMrByL,EAAQ/K,aAAe,SAAUgL,EAAQhK,EAAOgF,GACzB,iBAAVhF,IAAoBgK,EAAOhK,MAAQA,GAC9CgK,EAAOhF,QAAUA,EACjBgF,EAAOrG,UAAW,GAGpBoG,EAAQ9K,cAAgB,SAAU+K,EAAQhK,GACnB,iBAAVA,IAAoBgK,EAAOhK,MAAQA,GAC9CgK,EAAOrG,UAAW,GAGpBoG,EAAQ7K,aAAe,SAAU+K,EAAKlH,EAAa/C,GAC5B,iBAAVA,IAAoBiK,EAAIjK,MAAQA,GAChB,iBAAhB+C,IAA0BkH,EAAIlH,YAAcA,GACvDkH,EAAItG,UAAW,EACfsG,EAAIC,UAAW,EACfD,EAAIjF,aAAUrC,EACdsH,EAAIlG,MAAMoG,OAAS,WAGrBJ,EAAQ5K,YAAc,SAAU8K,EAAKjK,GACd,iBAAVA,IAAoBiK,EAAIjK,MAAQA,GAC3CiK,EAAItG,UAAW,EACfsG,EAAIC,UAAW,EACfD,EAAIjF,QAAU,kBAAM+E,EAAQjB,YAAYmB,IACxCA,EAAIlG,MAAMoG,OAAS,WAGrBJ,EAAQ3K,WAAa,SAAU6K,EAAKlH,GAClCgH,EAAQ7K,aAAa+K,EAAKlH,EAAa,IACvCkH,EAAItG,UAAW,GAOjBoG,EAAQ1K,QAAU,SAAU+K,GAAkC,IAAzBzD,EAAyB,uDAAlB,GAAI7D,EAAc,uDAAJ,GAClDuH,EAAY1D,EAAO,IAAMA,EAAO,KAChC2D,EAAcD,EAChB3L,EAAKkI,OAAO,OAAQyD,EAAWvH,GAC/BA,EACJpE,EAAKgB,QAAQ0K,EAAS1L,EAAKkI,OAAO,OAAQyD,EAAWC,KAGvDP,EAAQzK,OAAS,SAAUiL,EAAMH,GAC/BG,EAAO7L,EAAKkE,KAAKwH,GAAW1L,EAAK+D,KAAK2H,IAGxCL,EAAQS,WAAa,SAAUC,EAAMC,GACnChM,EAAKqB,OAAOvB,EAAI4H,KAAMqE,GACtB/L,EAAKqB,OAAOvB,EAAIL,KAAMuM,IAGxBX,EAAQjB,YAAc,SAAUsB,GAC9B,GAAI1L,EAAKoK,YAAYsB,IAAYjE,SAASwE,cAAc3K,MAAO,CAC7D,IAAM4K,EAAWlM,EAAKmM,KAAK,WACvBD,GAAUlM,EAAKoM,QAAQF,GAC3B,IAAMG,EAAarM,EAAKkI,OAAO,OAAQ,UAAW,UAClDwD,EAAQY,WAAWC,aAAaF,EAAYX,GAC5Cc,YAAW,WACTH,EAAWI,QAAS,IACnB,Q,kDCvEDzM,EAAOJ,EAAQ,GACf8M,EAAO9M,EAAQ,IAEfQ,EAAiBR,EAAQ,IACzBS,EAAMT,EAAQ,G,gCAIpB,4FACQmI,EAAWN,SAASM,SAASmD,MAAM,IAAK,GAAGyB,KAAK,KAChD/C,EAAO1D,SAAS0D,KAChBgD,EAASC,EAAWjD,IAGpBkD,EAAM9M,EAAKmM,KAAK,+CAClBY,QAAUD,EAAIC,QAAQhG,QACxB,iBADY,qGAKRgB,EALQ,UAUV6E,EAAOI,WACHA,EAAU5M,EAAe6M,KAAKL,EAAOI,UAEzC3M,EAAIkB,cAAgByL,EAEpB1I,QAAQd,MAAR,2BAAkCoJ,EAAOI,WAGzCJ,EAAOM,SACT7M,EAAIuB,OAA2B,UAAlBgL,EAAOM,QAGtB5I,QAAQ6I,IAAI,mBAAoBjE,OAAOkE,KAAKhN,EAAe6M,OAGvDI,EAAU,GACVT,EAAOU,IACTD,EAAQE,KAAKb,EAAKY,IAAL,UAAYvF,EAAZ,YAAwB6E,EAAOU,MAA/B,MAA4ChJ,QAAQd,SAEjE6J,EAAQE,KAAKb,EAAKY,IAAI,cAAT,MAA6BhJ,QAAQd,QAC9CoJ,EAAO,SACTS,EAAQE,KACNb,EAAKY,IAAL,UAAYvF,EAAZ,YAAwB6E,EAAO,UAA/B,MAAgDtI,QAAQd,SAI9DgK,QAAQC,IAAIJ,GAAS9J,MAAK,kBAAMvD,EAAKkE,KAAKuD,SAASC,SAGnD9H,EAAQ,IAGRsG,SAAS0D,KAAOA,EAjDlB,6C,sBAqDA,SAASiD,EAAY9L,GACnB,IAAM6L,EAAS,GAWf,OATA7L,EACGiB,OAAO,GACPkJ,MAAM,KACN/J,SAAQ,SAAAuM,GACP,IAAM5M,EAAM4M,EAAOxC,MAAM,IAAK,GAAG,GAC3ByC,EAAMD,EAAO1L,OAAOlB,EAAIkJ,OAAS,GACvC4C,EAAO9L,GAAO8M,mBAAmBD,MAG9Bf,G,mCAITiB","file":"app.js","sourcesContent":["\"use strict\"\nconst main = exports\n\nconst cosmicLib = require(\"cosmic-lib\")\nconst CosmicLink = cosmicLib.CosmicLink\nconst dom = require(\"@cosmic-plus/domutils/es5/dom\")\nconst env = require(\"@cosmic-plus/jsutils/es5/env\")\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\nconst QrCode = require(\"qrcode\")\nconst { timeout } = require(\"@cosmic-plus/jsutils/es5/misc\")\n\nconst TxResultView = require(\"./view/tx-result-view\")\n\nconst authenticators = require(\"./authenticators\")\nconst the = require(\"./shared\")\n\nconst {\n  enableButton,\n  disableButton,\n  readWriteBox,\n  readOnlyBox,\n  disableBox,\n  display,\n  showIf\n} = require(\"./helpers\")\n\n// Run once page is fully loaded\nmain.init = function () {\n  // Step 1: Transaction\n  if (!the.query) html.rewrite(dom.cosmiclink_description, \"No transaction\")\n\n  // Step 2: Authenticator\n  authenticators.nodes.forEach(entry => html.append(dom.authenticators, entry))\n  dom.authenticators.value = the.authenticator.name\n\n  // Step 3: Signing\n  if (the.redirect) dom.redirectionCheckbox.checked = true\n  if (the.qrCode) qrCodeUI.enable()\n\n  // CosmicLib network setup\n  for (let key in localStorage) {\n    if (key.substr(0, 8) === \"network:\") {\n      const id = key.substr(8)\n      const passphrase = cosmicLib.resolve.networkPassphrase(id)\n      cosmicLib.config.setupNetwork(id, localStorage[key], passphrase)\n    }\n  }\n}\n\nmain.refresh = async function () {\n  if (the.query) the.cosmicLink = new CosmicLink(the.query)\n  else the.cosmicLink = { tdesc: {} }\n  authenticatorUI.init()\n  redirectionUI.init()\n  if (the.cosmicLink.query) transactionUI.refresh()\n}\n\n/*******************************************************************************\n * Step 1: Transaction UI\n */\n\nconst transactionUI = {}\n\ntransactionUI.refresh = function () {\n  if (the.authenticator.needSource && !the.accountId) {\n    if (!the.authenticator.getAccountId) {\n      redirectionUI.error(\"Please set a source account\")\n    }\n    return\n  }\n  if (the.authenticator.needNetwork) {\n    if (dom.customNetwork.checked && (!the.horizon || !the.network)) {\n      redirectionUI.error(\"Please fill custom network fields\")\n      return\n    }\n  }\n\n  cosmicLib.config.source = the.accountId\n  cosmicLib.config.network = the.network\n\n  const saveTransaction = the.transaction = the.authenticator.handle(\n    the.cosmicLink\n  )\n\n  the.transaction\n    .then(function (value) {\n      if (the.transaction === saveTransaction) redirectionUI.refresh(value)\n    })\n    .catch(function () {\n      if (the.transaction === saveTransaction)\n        redirectionUI.error(the.cosmicLink.status)\n    })\n}\n\n/*******************************************************************************\n * Step 2: Authenticator UI\n */\n\nconst authenticatorUI = {}\n\nauthenticatorUI.init = function () {\n  display(dom.accountMsgbox, \"\")\n  the.authenticator = authenticators[dom.authenticators.value]\n  localStorage.authenticator = the.authenticator.name\n\n  if (the.authenticator.needSource) accountUI.init()\n  else accountUI.disable()\n  if (the.authenticator.needNetwork) networkUI.init()\n  else networkUI.disable()\n\n  if (the.authenticator.refresh) the.authenticator.refresh(main.refresh)\n}\n\n/**\n * AccountID box UI\n */\nconst accountUI = {}\n\naccountUI.disable = function () {\n  html.hide(dom.accountDiv)\n  the.accountId = undefined\n}\n\naccountUI.init = async function () {\n  html.show(dom.accountDiv)\n\n  if (!the.authenticator.getAccountId) {\n    if (the.cosmicLink.tdesc.source) {\n      if (the.cosmicLink.tdesc.source.error) {\n        disableBox(dom.accountIdBox, the.cosmicLink.tdesc.source.error.message)\n      } else {\n        the.accountId = true\n        readOnlyBox(dom.accountIdBox, the.cosmicLink.tdesc.source)\n      }\n    } else {\n      the.accountId = localStorage.accountId\n      readWriteBox(\n        dom.accountIdBox,\n        \"Federated Address or Public Key\",\n        the.accountId\n      )\n    }\n  } else {\n    the.accountId = undefined\n    disableBox(dom.accountIdBox, \"Connecting...\")\n\n    const authenticator = the.authenticator\n    try {\n      const accountId = await the.authenticator.getAccountId()\n      if (the.authenticator !== authenticator) return\n      the.accountId = accountId\n      readOnlyBox(dom.accountIdBox, accountId)\n      transactionUI.refresh()\n    } catch (error) {\n      if (the.authenticator !== authenticator) return\n      dom.accountIdBox.placeholder = \"Error\"\n      display(dom.accountMsgbox, \"error\", error.message + \".\")\n      console.error(error)\n    }\n  }\n}\n\n/**\n * Network selection UI\n */\nconst networkUI = {}\n\nnetworkUI.disable = function () {\n  html.hide(dom.networkDiv)\n  the.network = \"public\"\n  the.horizon = undefined\n}\n\nnetworkUI.init = function () {\n  html.show(dom.networkDiv)\n  html.hide(dom.customNetworkSetup)\n  the.network =\n    the.cosmicLink.tdesc.network || localStorage.networkSelector || \"public\"\n  the.horizon = undefined\n\n  switch (the.network) {\n  case undefined:\n  case \"public\":\n    dom.publicNetwork.checked = true\n    dom.networkSelector.scrollLeft = 0\n    break\n  case \"test\":\n    dom.testNetwork.checked = true\n    break\n  default:\n    if (dom.networkSelector.onscroll) dom.networkSelector.onscroll()\n    // Doesn't works when called synchronously.\n    timeout(1).then(() => dom.networkSelector.scrollLeft = 999)\n    dom.customNetwork.checked = true\n\n    html.show(dom.customNetworkSetup)\n    if (!the.network) the.network = localStorage.customPassphrase\n    the.horizon =\n        cosmicLib.resolve.horizon(the.network || \"\")\n        || the.cosmicLink.tdesc.horizon\n    dom.customPassphrase.value = the.network || \"\"\n    dom.customHorizon.value = the.horizon || \"\"\n  }\n\n  if (the.cosmicLink.tdesc.network) networkUI.lock()\n}\n\nnetworkUI.lock = function () {\n  readOnlyBox(dom.customPassphrase)\n  dom.publicNetwork.disabled = true\n  dom.testNetwork.disabled = true\n  dom.customNetwork.disabled = true\n}\n\nnetworkUI.switch = function (selector) {\n  localStorage.networkSelector = selector\n  main.refresh()\n}\n\n/**\n * HTML Elements Events\n */\n\ndom.authenticators.onchange = function () {\n  if (the.authenticator && the.authenticator.onExit) the.authenticator.onExit()\n  the.redirect = localStorage.redirect = false\n  dom.redirectionCheckbox.checked = false\n  main.refresh()\n}\n\ndom.accountIdBox.onchange = function () {\n  the.accountId = localStorage.accountId = dom.accountIdBox.value\n  main.refresh()\n}\n\ndom.networkSelector.onscroll = function () {\n  dom.networkSelector.style.textOverflow = \"initial\"\n  dom.networkSelector.onscroll = undefined\n}\n\ndom.publicNetwork.onchange = () => networkUI.switch(\"public\")\ndom.testNetwork.onchange = () => networkUI.switch(\"test\")\ndom.customNetwork.onchange = () => networkUI.switch(\"\")\n\ndom.customPassphrase.onchange = function () {\n  const networkName = cosmicLib.resolve.networkName(dom.customPassphrase.value)\n  localStorage.customPassphrase = networkName\n  networkUI.switch(\"\")\n}\n\ndom.customHorizon.onchange = function () {\n  the.horizon = dom.customHorizon.value\n  if (the.horizon && the.horizon.substr(0, 4) !== \"http\") {\n    the.horizon = \"https://\" + the.horizon\n  }\n  if (the.network && the.horizon) {\n    const passphrase = cosmicLib.resolve.networkPassphrase(the.network)\n    cosmicLib.config.setupNetwork(the.network, the.horizon, passphrase)\n    localStorage[\"network:\" + passphrase] = the.horizon\n  }\n  if (the.network) main.refresh()\n}\n\n/*******************************************************************************\n * Step 3: Signing/Redirection UI\n */\n\nconst redirectionUI = {}\n\nredirectionUI.init = function () {\n  redirectionUI.display(\"\")\n  showIf(the.authenticator.redirection, dom.redirectionForm)\n  showIf(the.authenticator.textarea, dom.textareaForm)\n  showIf(the.query && the.authenticator.qrCode, dom.qrForm)\n\n  if (!the.query) {\n    if (the.authenticator.url) {\n      const onclick = () => location.href = the.authenticator.url\n      enableButton(dom.redirectionButton, the.authenticator.buttonText, onclick)\n    } else {\n      redirectionUI.error(\"No transaction\")\n    }\n  } else {\n    if (the.authenticator.redirection) disableButton(dom.redirectionButton, \"…\")\n    if (the.authenticator.textarea) disableBox(dom.xdrBox, \"Computing...\")\n    if (the.authenticator.qrCode) qrCodeUI.loadingAnim()\n  }\n}\n\nredirectionUI.refresh = function (value) {\n  if (the.authenticator.redirection) {\n    const onclick = () => redirectionUI.click(value)\n    enableButton(dom.redirectionButton, the.authenticator.buttonText, onclick)\n  }\n\n  if (the.redirect && !the.contextIsWidget) {\n    dom.redirectionButton.onclick()\n  }\n\n  if (the.authenticator.textarea) readOnlyBox(dom.xdrBox, value)\n  if (the.authenticator.qrCode) qrCodeUI.refresh(value)\n}\n\nredirectionUI.error = function (error) {\n  disableButton(dom.redirectionButton, error)\n  disableBox(dom.xdrBox, error)\n  html.clear(dom.qrCode)\n}\n\nredirectionUI.click = async function (action) {\n  if (typeof action === \"string\") {\n    if (\n      the.contextIsWidget\n      || env.isEmbedded && the.authenticator.target === \"new\"\n    ) {\n      open(action, \"_blank\")\n      window.parent.postMessage(\"close\", \"*\")\n    } else if (env.isEmbedded && the.authenticator.target === \"external\") {\n      open(action)\n      window.parent.postMessage(\"close\", \"*\")\n    } else {\n      location.replace(action)\n    }\n  } else if (typeof action === \"function\") {\n    display(dom.redirectionMsgbox, \"info\", \"Waiting for confirmation...\")\n    dom.redirectionButton.disabled = true\n\n    try {\n      const transaction = await action()\n      await redirectionUI.sendTransaction(transaction)\n    } catch (error) {\n      console.error(error.response || error)\n      redirectionUI.display(\"error\", error.message.replace(/\\.$/, \"\"))\n      dom.redirectionButton.disabled = false\n    }\n  }\n}\n\nredirectionUI.sendTransaction = async function () {\n  redirectionUI.display(\"info\", \"Sending to the network...\")\n\n  // Ensure signatures are part of the XDR.\n  delete the.cosmicLink._query\n  delete the.cosmicLink._xdr\n  the.query = the.cosmicLink.query\n\n  history.replaceState({}, \"\", the.query)\n  networkUI.lock()\n\n  // Non-widget interface\n  if (dom.query) {\n    dom.query.textContent = the.query\n  }\n\n  window.scrollTo(0, document.body.scrollHeight)\n  const result = await TxResultView.forCosmicLink(the.cosmicLink)\n  redirectionUI.display(\"\", result)\n\n  if (result.validated && env.isEmbedded) {\n    parent.postMessage(\"close\", \"*\")\n  }\n  if (document.referrer) {\n    enableButton(dom.redirectionButton, \"Close\", () => history.back())\n  } else {\n    dom.redirectionButton.value = \"Done\"\n  }\n}\n\nredirectionUI.display = function (type, message) {\n  display(dom.redirectionMsgbox, type, message)\n}\n\nconst qrCodeUI = {}\n\nqrCodeUI.loadingAnim = function () {\n  html.rewrite(dom.qrCode, html.create(\"span\", \".cosmiclib_loadingAnim\"))\n}\n\nqrCodeUI.refresh = async function (value) {\n  // Makes that fuction non-blocking.\n  await timeout(0)\n\n  if (!the.authenticator.qrCode || !value) return\n\n  const canvas = html.create(\"canvas\", { title: value })\n  const scale = Math.max(3, 6 - Math.floor(Math.sqrt(value) / 10))\n  QrCode.toCanvas(canvas, value, { margin: 0, scale })\n\n  html.rewrite(dom.qrCode, canvas)\n}\n\nqrCodeUI.switch = function () {\n  the.qrCode = localStorage.QR = !the.qrCode\n  if (the.qrCode) qrCodeUI.enable()\n  else qrCodeUI.disable()\n}\n\nqrCodeUI.enable = function () {\n  dom.qrButton.className = \"enabled\"\n  html.show(dom.qrCode)\n}\n\nqrCodeUI.disable = function () {\n  dom.qrButton.className = undefined\n  html.hide(dom.qrCode)\n}\n\n/**\n * HTML Elements Events\n */\n\ndom.redirectionButton.onclick = redirectionUI.click\ndom.qrButton.onclick = qrCodeUI.switch\n\ndom.redirectionCheckbox.onchange = function () {\n  the.redirect = localStorage.redirect = !the.redirect\n}\n","\"use strict\"\n/**\n * TxResultView - Displays TxResult instances\n */\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\n\nconst TxResult = require(\"@cosmic-plus/tx-result\")\n\n/* Definition */\nclass TxResultView extends Gui {\n  static async forCosmicLink (cosmicLink) {\n    const result = await TxResult.forCosmicLink(cosmicLink)\n    return new TxResultView(result)\n  }\n\n  static fromResponse (response) {\n    const result = new TxResult(response)\n    return new TxResultView(result)\n  }\n\n  constructor (txResult) {\n    super(`\n<div class=\"cosmiclink_description\">\n\n  <span class=%state>%title</span>\n\n  <ul class=\"error\" hidden=%validated>\n    %{toLi:errors...}\n  </ul>\n\n</div>\n    `)\n\n    Object.assign(this, txResult)\n    this.state = this.validated ? \"info\" : \"error\"\n  }\n\n  has (obj) {\n    return !!obj\n  }\n  toLi (msg) {\n    return html.create(\"li\", null, msg)\n  }\n}\n\n/* Exports */\nmodule.exports = TxResultView\n","\"use strict\"\n/**\n * Robot tamper.\n */\nconst dom = require(\"@cosmic-plus/domutils/es5/dom\")\n\nfunction myHash () {\n  if (localStorage.myHash) return localStorage.myHash\n\n  var alphabet =\n    \"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\"\n  var size = 32\n\n  var hash = \"\"\n  for (var i = 0; i < size; i++) {\n    hash += alphabet.charAt(Math.floor(Math.random() * alphabet.length))\n  }\n\n  localStorage.myHash = hash\n  return hash\n}\n\ndom.tamper.src = \"https://robohash.org/\" + myHash()\n","\"use strict\"\n/**\n * Cosmic.Link Graphical User Interface\n */\nconst the = require(\"./shared\")\n\nif (the.contextIsWidget) {\n  require(\"./app-widget\")\n} else {\n  require(\"./app-interface\")\n}\n","\"use strict\"\n/**\n * App interface initialization.\n */\nconst cosmicLib = require(\"cosmic-lib\")\nconst dom = require(\"@cosmic-plus/domutils/es5/dom\")\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\nconst Page = require(\"@cosmic-plus/domutils/es5/page\")\n\nconst the = require(\"./shared\")\nconst { copyContent } = require(\"./helpers\")\n\n/* Functions */\n\nfunction initInterface () {\n  // Signing interface\n  const signingUI = require(\"./signing-ui\")\n  const signingPage = Page.add(\"Sign\", dom.sign)\n  signingPage.onSelect = function () {\n    history.replaceState(\"\", null, location.pathname + location.search)\n    signingUI.refresh()\n  }\n  signingUI.init()\n\n  // Non-widget components\n  if (!the.contextIsWidget) {\n    initNonWidgetInterface()\n  }\n\n  // Default page\n  if (Page.current === signingPage) signingPage.onSelect()\n  else if (!Page.current) Page.select(\"#sign\")\n}\n\nfunction initNonWidgetInterface () {\n  // Header\n  if (location.origin === \"null\") {\n    dom.websiteUrl.textContent = location.pathname\n  } else {\n    dom.websiteUrl.textContent = location.origin + location.pathname\n  }\n  dom.query.textContent = location.search\n  dom.header.onclick = () => copyContent(dom.header)\n\n  // About page\n  Page.add(\"About\", dom.about)\n\n  // SEP-0007\n  if (cosmicLib.sep7Utils.isWebHandlerSupported()) {\n    dom.registerSep7Handler.onclick = () => {\n      cosmicLib.sep7Utils.registerWebHandler(\n        location.href.split(/[?#]/, 1)[0],\n        \"Cosmic.link\"\n      )\n    }\n  } else {\n    // (hack) Keep the collapsed bottom margin.\n    dom.registerSep7Handler.textContent = \"\"\n  }\n  html.show(dom.registerSep7Handler)\n\n  // Robot tamper\n  require(\"./tamper\")\n}\n\n/* Init */\ninitInterface()\n","\"use strict\"\n/**\n * Generic helpers\n */\nconst helpers = exports\n\nconst dom = require(\"@cosmic-plus/domutils/es5/dom\")\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\n\n/*******************************************************************************\n * Form Elements Helpers\n */\n\nhelpers.enableButton = function (button, value, onclick) {\n  if (typeof value === \"string\") button.value = value\n  button.onclick = onclick\n  button.disabled = false\n}\n\nhelpers.disableButton = function (button, value) {\n  if (typeof value === \"string\") button.value = value\n  button.disabled = true\n}\n\nhelpers.readWriteBox = function (box, placeholder, value) {\n  if (typeof value === \"string\") box.value = value\n  if (typeof placeholder === \"string\") box.placeholder = placeholder\n  box.disabled = false\n  box.readOnly = false\n  box.onclick = undefined\n  box.style.cursor = \"initial\"\n}\n\nhelpers.readOnlyBox = function (box, value) {\n  if (typeof value === \"string\") box.value = value\n  box.disabled = false\n  box.readOnly = true\n  box.onclick = () => helpers.copyContent(box)\n  box.style.cursor = \"pointer\"\n}\n\nhelpers.disableBox = function (box, placeholder) {\n  helpers.readWriteBox(box, placeholder, \"\")\n  box.disabled = true\n}\n\n/*******************************************************************************\n * Other Helpers\n */\n\nhelpers.display = function (element, type = \"\", message = \"\") {\n  const classname = type ? \".\" + type : null\n  const messageNode = classname\n    ? html.create(\"span\", classname, message)\n    : message\n  html.rewrite(element, html.create(\"span\", classname, messageNode))\n}\n\nhelpers.showIf = function (flag, element) {\n  flag ? html.show(element) : html.hide(element)\n}\n\nhelpers.switchPage = function (from, to) {\n  html.append(dom.body, from)\n  html.append(dom.main, to)\n}\n\nhelpers.copyContent = function (element) {\n  if (html.copyContent(element) && document.activeElement.value) {\n    const prevNode = html.grab(\"#copied\")\n    if (prevNode) html.destroy(prevNode)\n    const copiedNode = html.create(\"span\", \"#copied\", \"Copied\")\n    element.parentNode.insertBefore(copiedNode, element)\n    setTimeout(() => {\n      copiedNode.hidden = true\n    }, 3000)\n  }\n}\n","\"use strict\"\n/**\n * Widget interface initialization.\n */\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\nconst load = require(\"@cosmic-plus/domutils/es5/load\")\n\nconst authenticators = require(\"./authenticators\")\nconst the = require(\"./shared\")\n\n/* Functions */\n\nasync function initWidget () {\n  const referrer = document.referrer.split(\"/\", 3).join(\"/\")\n  const hash = location.hash\n  const params = parseQuery(hash)\n\n  // Strengthen Content-Security-Policy.\n  const csp = html.grab(\"meta[http-equiv='Content-Security-Policy']\")\n  csp.content = csp.content.replace(\n    \"style-src *  ;\",\n    `\n    style-src 'self'\n      'sha256-UpnKee22eAiBMULu1lvaV7de7xOzTjdN7K/WZDBil10='\n      ${referrer};\n  `\n  )\n\n  // Interface control.\n  if (params.handler) {\n    const handler = authenticators.byId[params.handler]\n    if (handler) {\n      the.authenticator = handler\n    } else {\n      console.error(`Unknown handler: ${params.handler}`)\n    }\n  }\n  if (params.qrcode) {\n    the.qrCode = params.qrcode !== \"false\"\n  }\n  // eslint-disable-next-line no-console\n  console.log(\"Valid handlers: \", Object.keys(authenticators.byId))\n\n  // Style control (asynchronous).\n  let loading = []\n  if (params.css) {\n    loading.push(load.css(`${referrer}/${params.css}`).catch(console.error))\n  } else {\n    loading.push(load.css(\"widget.css\").catch(console.error))\n    if (params[\"css+\"]) {\n      loading.push(\n        load.css(`${referrer}/${params[\"css+\"]}`).catch(console.error)\n      )\n    }\n  }\n  Promise.all(loading).then(() => html.show(document.body))\n\n  // Interface initialization.\n  require(\"./app-interface\")\n\n  // Consistent reload (app-interface mess with location.hash)\n  location.hash = hash\n}\n\n/* Helpers */\nfunction parseQuery (query) {\n  const params = {}\n\n  query\n    .substr(1)\n    .split(\"&\")\n    .forEach(keyval => {\n      const key = keyval.split(\"=\", 1)[0]\n      const val = keyval.substr(key.length + 1)\n      params[key] = decodeURIComponent(val)\n    })\n\n  return params\n}\n\n/* Initialization */\ninitWidget()\n"],"sourceRoot":""}